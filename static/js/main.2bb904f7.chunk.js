(this["webpackJsonpmusic-playlist"]=this["webpackJsonpmusic-playlist"]||[]).push([[0],{110:function(t,e,a){},111:function(t,e,a){},128:function(t,e,a){"use strict";a.r(e);var n,c,r=a(3),i=a.n(r),s=a(57),l=a.n(s),o=(a(110),a(111),a(31)),u=a.n(o),d=a(50),j=a(79),h=a.n(j),b=a(43),x=a(90),p=a(91),m=a(13),f=function(){function t(){Object(x.a)(this,t),this.tracks=[],this.currentTrack=null,this.playing=!1,this.isLoading=!0,this.volume=1,this.currentTime=0,this.duration=0,this.url="".concat("http://localhost:5000","/graphql"),Object(m.d)(this,{},{autoBind:!0})}return Object(p.a)(t,[{key:"setDuration",value:function(t){this.duration=t}},{key:"setCurrentTime",value:function(t){this.currentTime=t}},{key:"setVolume",value:function(t){this.volume=t}},{key:"setLoading",value:function(t){this.isLoading=t}},{key:"setTracks",value:function(t){this.tracks=t}},{key:"setPlaying",value:function(t){this.playing=t}},{key:"setCurrentTrack",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currentTrack=t,this.setPlaying(e)}},{key:"addToTracks",value:function(t){this.tracks.push(t)}},{key:"prevTrack",value:function(){var t=this.tracks.indexOf(this.currentTrack);0===t?this.setCurrentTrack(this.tracks[this.tracks.length-1]):this.setCurrentTrack(this.tracks[t-1])}},{key:"nextTrack",value:function(){var t=this.tracks.indexOf(this.currentTrack);t===this.tracks.length-1?this.setCurrentTrack(this.tracks[0]):this.setCurrentTrack(this.tracks[t+1])}},{key:"handleEnd",value:function(){this.nextTrack()}}]),t}(),k=new f,O=a(44),_=a(70),v=a.n(_),g=a(34),y=a(92),T=a.n(y),N=a(2),I=function(){return Object(N.jsx)("div",{className:T.a.box,children:Object(N.jsx)(O.a,{style:{fontSize:"1.7rem"},icon:g.a,color:"black"})})},P=function(t){var e=t.toggleAudio,a=t.nextTrack,n=t.prevTrack,c=t.playing;return Object(N.jsxs)("div",{className:v.a.controlsBox,children:[Object(N.jsx)("div",{className:v.a.musicImage,children:Object(N.jsx)(I,{})}),Object(N.jsx)(O.a,{className:"clickable",onClick:e,style:{fontSize:"2.5rem"},icon:c?g.b:g.c,color:"black"}),Object(N.jsxs)("div",{className:v.a.controls,children:[Object(N.jsx)(O.a,{className:"clickable",style:{fontSize:"1.5rem"},icon:g.d,color:"black",onClick:n}),Object(N.jsx)(O.a,{className:"clickable",style:{fontSize:"1.5rem"},icon:g.e,color:"black",onClick:a})]})]})},C=a(36),w=a.n(C),B=function(t){var e=Math.floor(t/60),a=Math.floor(t%60),n=e<10?"0".concat(e):"".concat(e),c=a<10?"0".concat(a):"".concat(a);return"".concat(n,":").concat(c)},S=function(t){var e=t.track,a=t.duration,n=t.currentTime,c=t.handleProgress;return Object(N.jsxs)("div",{className:w.a.info,children:[Object(N.jsxs)("div",{className:w.a.infoInnerBox,children:[Object(N.jsx)("h2",{className:w.a.title,children:null===e||void 0===e?void 0:e.title}),Object(N.jsx)("p",{children:B(a)})]}),Object(N.jsxs)("div",{className:w.a.infoInnerBox,children:[Object(N.jsx)("h3",{className:w.a.title,children:null===e||void 0===e?void 0:e.author}),Object(N.jsx)("p",{children:B(n)})]}),Object(N.jsx)("input",{className:w.a.progressBar,type:"range",onChange:c,value:a?Math.round(100*n/a):0})]})},M=a(80),F=a.n(M),A=function(t){var e=t.volumeState,a=t.handleVolume;return Object(N.jsxs)("div",{className:F.a.box,children:[Object(N.jsxs)("p",{className:F.a.title,children:["Volume: ",Math.round(100*e),"%"]}),Object(N.jsx)("input",{className:"clickable",type:"range",value:Math.round(100*e),onChange:function(t){return a(t)}})]})},U=new Audio,L=!0,V=Object(b.a)((function(){var t=k.currentTime,e=k.duration,a=k.volume,n=k.playing,c=k.currentTrack,i=k.nextTrack,s=k.prevTrack,l=k.setCurrentTime,o=k.setDuration,j=k.setVolume,b=k.setPlaying,x=k.handleEnd;Object(r.useEffect)((function(){c&&(U.src=c.src,U.ontimeupdate=function(){return l(U.currentTime)},U.onloadeddata=function(){L=!0,o(U.duration)},U.onended=function(){L=!1,x()},p())}),[c]);var p=function(){var t=Object(d.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!U.paused){t.next=12;break}return b(!0),t.prev=2,t.next=5,U.play();case 5:t.next=10;break;case 7:t.prev=7,t.t0=t.catch(2),console.log(t.t0);case 10:t.next=14;break;case 12:b(!1),U.pause();case 14:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(){return t.apply(this,arguments)}}();return c?Object(N.jsx)("div",{className:h.a.player,children:Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(P,{toggleAudio:p,nextTrack:i,prevTrack:s,playing:n}),Object(N.jsx)("div",{className:h.a.musicImage,children:Object(N.jsx)(I,{})}),Object(N.jsx)(S,{track:c,duration:e,currentTime:t,handleProgress:function(t){if(L){var a=t.target.value*e/100;U.currentTime=a,l(a)}}}),Object(N.jsx)(A,{volumeState:a,handleVolume:function(t){var e=t.target.value/100;j(e),U.volume=e}})]})}):null})),q=V,E=a(35),W=a(81),$=a.n(W),z=function(){return Object(N.jsx)("div",{className:$.a.loadingWrapper,children:Object(N.jsx)("div",{className:$.a.loading})})},D=a(25),J=a.n(D),Y=Object(b.a)((function(t){var e=t.track,a=t.index,n=k.tracks,c=k.setCurrentTrack,r=k.currentTrack,i=!1;return r&&(i=n[a].id===r.id),Object(N.jsxs)("button",{className:i?"".concat(J.a.track," ").concat(J.a.active):J.a.track,onClick:function(){return!i&&c(e)},children:[Object(N.jsx)("div",{className:J.a.trackBox}),Object(N.jsxs)("div",{className:J.a.info,children:[Object(N.jsx)("div",{className:J.a.innerBox,children:Object(N.jsx)("h2",{className:J.a.text,children:e.title})}),Object(N.jsx)("div",{className:J.a.innerBox,children:Object(N.jsx)("h3",{className:J.a.text,children:e.author})})]})]})})),K=a(37),R=a.n(K),G=a(54),H=a.n(G),Z=a(138),Q=a(55),X=a.n(Q),tt=a(64),et=a(40),at=Object(et.d)(n||(n=Object(tt.a)(["\n  mutation addTrack($title: String!, $author: String!, $file: Upload!) {\n    addTrack(title: $title, author: $author, file: $file) {\n      src\n      author\n      title\n      id\n    }\n  }\n"]))),nt=a(93),ct=a.n(nt),rt=Object(r.memo)((function(t){var e=t.inputState,a=t.setInputState,n=t.label,c=t.id;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("label",{htmlFor:c,children:Object(N.jsx)("h3",{children:n})}),Object(N.jsx)("input",{id:c,required:!0,className:ct.a.input,value:e,onChange:function(t){return a(t.target.value)},type:"text"})]})})),it=function(t){var e=t.setModal,a=k.addToTracks,n=Object(r.useState)(null),c=Object(E.a)(n,2),i=c[0],s=c[1],l=Object(r.useState)(""),o=Object(E.a)(l,2),j=o[0],h=o[1],b=Object(r.useState)(""),x=Object(E.a)(b,2),p=x[0],m=x[1],f=Object(Z.a)(at),O=Object(E.a)(f,2),_=O[0],v=O[1].loading,g=function(){var t=Object(d.a)(u.a.mark((function t(e){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.target.files[0];case 2:(a=t.sent).type.includes("audio/")?s(a):alert("\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 audio/mpeg \u0444\u0430\u0439\u043b");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),y=function(){var t=Object(d.a)(u.a.mark((function t(n){var c,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,_({variables:{title:j,author:p,file:i}});case 4:c=t.sent,r=c.data.addTrack,a(r),e(!1),m(""),h(""),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),alert("Failed to upload track to server"),console.log("upload failed: ",t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}();return v?Object(N.jsxs)("div",{children:[Object(N.jsx)(z,{}),Object(N.jsx)("p",{className:X.a.uploadTitle,children:"Uploading track. Please wait."})]}):Object(N.jsxs)("form",{action:"",onSubmit:y,children:[Object(N.jsx)("h1",{className:X.a.title,children:"Upload Track"}),Object(N.jsx)(rt,{inputState:p,setInputState:m,id:"author",label:"Author"}),Object(N.jsx)(rt,{inputState:j,setInputState:h,id:"title",label:"Title"}),Object(N.jsx)("label",{htmlFor:"file",children:Object(N.jsx)("h1",{className:X.a.uploadTitle,children:"Upload audio File"})}),Object(N.jsx)("input",{required:!0,id:"file",type:"file",accept:"audio/*",onChange:g}),Object(N.jsx)("button",{className:X.a.btn,type:"submit",children:"UPLOAD TRACK"})]})},st=Object(r.memo)((function(t){var e=t.modal,a=t.setModal;return Object(N.jsx)("div",{onClick:function(){return a(!e)},className:e?"".concat(H.a.wrapper," ").concat(H.a.active):H.a.wrapper,children:Object(N.jsx)("div",{onClick:function(t){return t.stopPropagation()},className:H.a.inner,children:Object(N.jsx)(it,{setModal:a})})})})),lt=a(136),ot=Object(et.d)(c||(c=Object(tt.a)(["\n  query GetAllTracks {\n    getAllTracks {\n      id\n      title\n      author\n      src\n    }\n  }\n"]))),ut=Object(b.a)((function(){var t=Object(lt.a)(ot),e=t.data,a=t.loading,n=t.error,c=k.setTracks,i=k.tracks,s=Object(r.useState)(!1),l=Object(E.a)(s,2),o=l[0],u=l[1];return Object(r.useEffect)((function(){a||c(null===e||void 0===e?void 0:e.getAllTracks)}),[a]),n?Object(N.jsx)("div",{children:Object(N.jsx)("p",{style:{textAlign:"center"},className:R.a.title,children:"Connection Error"})}):Object(N.jsx)("section",{className:R.a.playlist,children:a?Object(N.jsx)(z,{}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:R.a.buttonFlex,children:[Object(N.jsx)("h1",{className:R.a.title,children:"Playlist: ".concat(i.length)}),Object(N.jsx)("button",{onClick:function(){return u(!o)},className:R.a.btn,children:"Add new track"})]}),Object(N.jsx)("ul",{className:R.a.tracksBlock,children:i.map((function(t,e){return Object(N.jsx)("li",{children:Object(N.jsx)(Y,{track:t,index:e})},t.id)}))}),Object(N.jsx)(st,{modal:o,setModal:u})]})})})),dt=a(77),jt=a(137),ht=a(134),bt=a.n(ht),xt="".concat("http://localhost:5000","/graphql"),pt=bt()({uri:xt}),mt=new dt.a({link:pt,cache:new jt.a}),ft=a(135),kt=function(){return Object(N.jsx)(ft.a,{client:mt,children:Object(N.jsxs)("div",{className:"container",children:[Object(N.jsx)(q,{}),Object(N.jsx)(ut,{})]})})};l.a.render(Object(N.jsx)(i.a.StrictMode,{children:Object(N.jsx)(kt,{})}),document.getElementById("root"))},25:function(t,e,a){t.exports={track:"TrackItem_track__2xVXN",info:"TrackItem_info__28yKf",innerBox:"TrackItem_innerBox__3AjsB",text:"TrackItem_text__3LC2R",active:"TrackItem_active__1JYrQ",trackBox:"TrackItem_trackBox__JnOlo"}},36:function(t,e,a){t.exports={infoInnerBox:"PlayerInfo_infoInnerBox__ZoIcs",title:"PlayerInfo_title__2Um7m",progressBar:"PlayerInfo_progressBar__2pcLC",info:"PlayerInfo_info__1_ZR_"}},37:function(t,e,a){t.exports={playlist:"Playlist_playlist__W8_YI",title:"Playlist_title__35xpX",buttonFlex:"Playlist_buttonFlex__3HBih",btn:"Playlist_btn__3H3G6",tracksBlock:"Playlist_tracksBlock__2h1D0"}},54:function(t,e,a){t.exports={wrapper:"UploadModal_wrapper__3yRYf",active:"UploadModal_active__36Haq",inner:"UploadModal_inner__3Kp__"}},55:function(t,e,a){t.exports={title:"UploadForm_title__3TYAS",btn:"UploadForm_btn__2j8Wb",uploadTitle:"UploadForm_uploadTitle__TUpZY"}},70:function(t,e,a){t.exports={controls:"PlayerControls_controls__1Paow",controlsBox:"PlayerControls_controlsBox__2-GwW",musicImage:"PlayerControls_musicImage__25dQk"}},79:function(t,e,a){t.exports={player:"Player_player__3VJ35",musicImage:"Player_musicImage__1w-aM"}},80:function(t,e,a){t.exports={box:"PlayerVolume_box__ztdcc",title:"PlayerVolume_title__1wp3r"}},81:function(t,e,a){t.exports={loadingWrapper:"Loading_loadingWrapper__2Lhoj",loading:"Loading_loading__-v3sh",load:"Loading_load__1ige4"}},92:function(t,e,a){t.exports={box:"PlayerMusicImage_box__1uK4L"}},93:function(t,e,a){t.exports={input:"FormInput_input__Owuwx"}}},[[128,1,2]]]);
//# sourceMappingURL=main.2bb904f7.chunk.js.map