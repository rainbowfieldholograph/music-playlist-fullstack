(this["webpackJsonpmusic-playlist"]=this["webpackJsonpmusic-playlist"]||[]).push([[0],{110:function(e,t,a){},111:function(e,t,a){},128:function(e,t,a){"use strict";a.r(t);var n,c,r=a(3),i=a.n(r),s=a(57),l=a.n(s),o=(a(110),a(111),a(31)),u=a.n(o),d=a(50),j=a(79),b=a.n(j),h=a(43),p=a(90),x=a(91),m=a(13),k=function(){function e(){Object(p.a)(this,e),this.tracks=[],this.currentTrack=null,this.playing=!1,this.isLoading=!0,this.volume=1,this.currentTime=0,this.duration=0,this.url="".concat("https://eyes-closed-server.herokuapp.com","/graphql"),Object(m.d)(this,{},{autoBind:!0})}return Object(x.a)(e,[{key:"setDuration",value:function(e){this.duration=e}},{key:"setCurrentTime",value:function(e){this.currentTime=e}},{key:"setVolume",value:function(e){this.volume=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"setTracks",value:function(e){this.tracks=e}},{key:"setPlaying",value:function(e){this.playing=e}},{key:"setCurrentTrack",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currentTrack=e,this.setPlaying(t)}},{key:"addToTracks",value:function(e){this.tracks.push(e)}},{key:"prevTrack",value:function(){var e=this.tracks.indexOf(this.currentTrack);0===e?this.setCurrentTrack(this.tracks[this.tracks.length-1]):this.setCurrentTrack(this.tracks[e-1])}},{key:"nextTrack",value:function(){var e=this.tracks.indexOf(this.currentTrack);e===this.tracks.length-1?this.setCurrentTrack(this.tracks[0]):this.setCurrentTrack(this.tracks[e+1])}},{key:"handleEnd",value:function(){this.nextTrack()}}]),e}(),f=new k,_=a(44),O=a(70),v=a.n(O),g=a(34),y=a(92),T=a.n(y),N=a(2),P=function(){return Object(N.jsx)("div",{className:T.a.box,children:Object(N.jsx)(_.a,{style:{fontSize:"1.7rem"},icon:g.a,color:"black"})})},I=function(e){var t=e.toggleAudio,a=e.nextTrack,n=e.prevTrack,c=e.playing;return Object(N.jsxs)("div",{className:v.a.wrapper,children:[Object(N.jsx)("div",{className:v.a.musicImage,children:Object(N.jsx)(P,{})}),Object(N.jsx)(_.a,{className:"clickable",onClick:t,style:{fontSize:"2.5rem"},icon:c?g.b:g.c,color:"black"}),Object(N.jsxs)("div",{className:v.a.controls,children:[Object(N.jsx)(_.a,{className:"clickable",style:{fontSize:"1.5rem"},icon:g.d,color:"black",onClick:n}),Object(N.jsx)(_.a,{className:"clickable",style:{fontSize:"1.5rem"},icon:g.e,color:"black",onClick:a})]})]})},w=a(36),C=a.n(w),B=function(e){var t=Math.floor(e/60),a=Math.floor(e%60),n=t<10?"0".concat(t):"".concat(t),c=a<10?"0".concat(a):"".concat(a);return"".concat(n,":").concat(c)},S=function(e){var t=e.track,a=e.duration,n=e.currentTime,c=e.handleProgress;return Object(N.jsxs)("div",{className:C.a.info,children:[Object(N.jsxs)("div",{className:C.a.infoInnerBox,children:[Object(N.jsx)("h2",{className:C.a.title,children:null===t||void 0===t?void 0:t.title}),Object(N.jsx)("p",{children:B(a)})]}),Object(N.jsxs)("div",{className:C.a.infoInnerBox,children:[Object(N.jsx)("h3",{className:C.a.title,children:null===t||void 0===t?void 0:t.author}),Object(N.jsx)("p",{children:B(n)})]}),Object(N.jsx)("input",{className:C.a.progressBar,type:"range",onChange:c,value:a?Math.round(100*n/a):0})]})},M=a(80),F=a.n(M),A=function(e){var t=e.volumeState,a=e.handleVolume;return Object(N.jsxs)("div",{className:F.a.box,children:[Object(N.jsxs)("p",{className:F.a.title,children:["Volume: ",Math.round(100*t),"%"]}),Object(N.jsx)("input",{className:"clickable",type:"range",value:Math.round(100*t),onChange:function(e){return a(e)}})]})},U=new Audio,L=!0,V=Object(h.a)((function(){var e=f.currentTime,t=f.duration,a=f.volume,n=f.playing,c=f.currentTrack,i=f.nextTrack,s=f.prevTrack,l=f.setCurrentTime,o=f.setDuration,j=f.setVolume,h=f.setPlaying,p=f.handleEnd;Object(r.useEffect)((function(){c&&(U.src=c.src,U.ontimeupdate=function(){return l(U.currentTime)},U.onloadeddata=function(){L=!0,o(U.duration)},U.onended=function(){L=!1,p()},x())}),[c]);var x=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!U.paused){e.next=12;break}return h(!0),e.prev=2,e.next=5,U.play();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log(e.t0);case 10:e.next=14;break;case 12:h(!1),U.pause();case 14:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(){return e.apply(this,arguments)}}();return c?Object(N.jsx)("div",{className:b.a.player,children:Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(I,{toggleAudio:x,nextTrack:i,prevTrack:s,playing:n}),Object(N.jsx)("div",{className:b.a.musicImage,children:Object(N.jsx)(P,{})}),Object(N.jsx)(S,{track:c,duration:t,currentTime:e,handleProgress:function(e){if(L){var a=e.target.value*t/100;U.currentTime=a,l(a)}}}),Object(N.jsx)(A,{volumeState:a,handleVolume:function(e){var t=e.target.value/100;j(t),U.volume=t}})]})}):null})),q=V,E=a(35),W=a(81),$=a.n(W),z=function(){return Object(N.jsx)("div",{className:$.a.loadingWrapper,children:Object(N.jsx)("div",{className:$.a.loading})})},D=a(25),G=a.n(D),J=Object(h.a)((function(e){var t=e.track,a=e.index,n=f.tracks,c=f.setCurrentTrack,r=f.currentTrack,i=!1;return r&&(i=n[a].id===r.id),Object(N.jsxs)("button",{className:i?"".concat(G.a.track," ").concat(G.a.active):G.a.track,onClick:function(){return!i&&c(t)},children:[Object(N.jsx)("div",{className:G.a.trackBox}),Object(N.jsxs)("div",{className:G.a.info,children:[Object(N.jsx)("div",{className:G.a.innerBox,children:Object(N.jsx)("h2",{className:G.a.text,children:t.title})}),Object(N.jsx)("div",{className:G.a.innerBox,children:Object(N.jsx)("h3",{className:G.a.text,children:t.author})})]})]})})),Y=a(37),Z=a.n(Y),H=a(54),K=a.n(H),R=a(138),Q=a(55),X=a.n(Q),ee=a(64),te=a(40),ae=Object(te.d)(n||(n=Object(ee.a)(["\n  mutation addTrack($title: String!, $author: String!, $file: Upload!) {\n    addTrack(title: $title, author: $author, file: $file) {\n      src\n      author\n      title\n      id\n    }\n  }\n"]))),ne=a(93),ce=a.n(ne),re=Object(r.memo)((function(e){var t=e.inputState,a=e.setInputState,n=e.label,c=e.id;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("label",{htmlFor:c,children:Object(N.jsx)("h3",{children:n})}),Object(N.jsx)("input",{id:c,required:!0,className:ce.a.input,value:t,onChange:function(e){return a(e.target.value)},type:"text"})]})})),ie=function(e){var t=e.setModal,a=f.addToTracks,n=Object(r.useState)(null),c=Object(E.a)(n,2),i=c[0],s=c[1],l=Object(r.useState)(""),o=Object(E.a)(l,2),j=o[0],b=o[1],h=Object(r.useState)(""),p=Object(E.a)(h,2),x=p[0],m=p[1],k=Object(R.a)(ae),_=Object(E.a)(k,2),O=_[0],v=_[1].loading,g=function(){var e=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.target.files[0];case 2:(a=e.sent).type.includes("audio/")?s(a):alert("\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 audio/mpeg \u0444\u0430\u0439\u043b");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(u.a.mark((function e(n){var c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,O({variables:{title:j,author:x,file:i}});case 4:c=e.sent,r=c.data.addTrack,a(r),t(!1),m(""),b(""),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),alert("Failed to upload track to server"),console.log("upload failed: ",e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return v?Object(N.jsxs)("div",{children:[Object(N.jsx)(z,{}),Object(N.jsx)("p",{className:X.a.uploadTitle,children:"Uploading track. Please wait."})]}):Object(N.jsxs)("form",{action:"",onSubmit:y,children:[Object(N.jsx)("h1",{className:X.a.title,children:"Upload Track"}),Object(N.jsx)(re,{inputState:x,setInputState:m,id:"author",label:"Author"}),Object(N.jsx)(re,{inputState:j,setInputState:b,id:"title",label:"Title"}),Object(N.jsx)("label",{htmlFor:"file",children:Object(N.jsx)("h1",{className:X.a.uploadTitle,children:"Upload audio File"})}),Object(N.jsx)("input",{required:!0,id:"file",type:"file",accept:"audio/*",onChange:g}),Object(N.jsx)("button",{className:X.a.btn,type:"submit",children:"UPLOAD TRACK"})]})},se=Object(r.memo)((function(e){var t=e.modal,a=e.setModal;return Object(N.jsx)("div",{onClick:function(){return a(!t)},className:t?"".concat(K.a.wrapper," ").concat(K.a.active):K.a.wrapper,children:Object(N.jsx)("div",{onClick:function(e){return e.stopPropagation()},className:K.a.inner,children:Object(N.jsx)(ie,{setModal:a})})})})),le=a(136),oe=Object(te.d)(c||(c=Object(ee.a)(["\n  query GetAllTracks {\n    getAllTracks {\n      id\n      title\n      author\n      src\n    }\n  }\n"]))),ue=Object(h.a)((function(){var e=Object(le.a)(oe),t=e.data,a=e.loading,n=e.error,c=f.setTracks,i=f.tracks,s=Object(r.useState)(!1),l=Object(E.a)(s,2),o=l[0],u=l[1];return Object(r.useEffect)((function(){a||c(null===t||void 0===t?void 0:t.getAllTracks)}),[a]),n?Object(N.jsx)("div",{children:Object(N.jsx)("p",{style:{textAlign:"center"},className:Z.a.title,children:"Connection Error"})}):Object(N.jsx)("section",{className:Z.a.playlist,children:a?Object(N.jsx)(z,{}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:Z.a.buttonFlex,children:[Object(N.jsx)("h1",{className:Z.a.title,children:"Playlist: ".concat(i.length)}),Object(N.jsx)("button",{onClick:function(){return u(!o)},className:Z.a.btn,children:"Add new track"})]}),Object(N.jsx)("ul",{className:Z.a.tracksBlock,children:i.map((function(e,t){return Object(N.jsx)("li",{children:Object(N.jsx)(J,{track:e,index:t})},e.id)}))}),Object(N.jsx)(se,{modal:o,setModal:u})]})})})),de=a(77),je=a(137),be=a(134),he=a.n(be),pe="".concat("https://eyes-closed-server.herokuapp.com","/graphql"),xe=he()({uri:pe}),me=new de.a({link:xe,cache:new je.a}),ke=a(135),fe=function(){return Object(N.jsx)(ke.a,{client:me,children:Object(N.jsxs)("div",{className:"container",children:[Object(N.jsx)(q,{}),Object(N.jsx)(ue,{})]})})};l.a.render(Object(N.jsx)(i.a.StrictMode,{children:Object(N.jsx)(fe,{})}),document.getElementById("root"))},25:function(e,t,a){e.exports={track:"TrackItem_track__1FyQV",info:"TrackItem_info__2JbXp",innerBox:"TrackItem_innerBox__3vbsZ",text:"TrackItem_text__4G18P",active:"TrackItem_active__N_Pac",trackBox:"TrackItem_trackBox__32aAP"}},36:function(e,t,a){e.exports={infoInnerBox:"PlayerInfo_infoInnerBox__ZoIcs",title:"PlayerInfo_title__2Um7m",progressBar:"PlayerInfo_progressBar__2pcLC",info:"PlayerInfo_info__1_ZR_"}},37:function(e,t,a){e.exports={playlist:"Playlist_playlist__W8_YI",title:"Playlist_title__35xpX",buttonFlex:"Playlist_buttonFlex__3HBih",btn:"Playlist_btn__3H3G6",tracksBlock:"Playlist_tracksBlock__2h1D0"}},54:function(e,t,a){e.exports={wrapper:"UploadModal_wrapper__3yRYf",active:"UploadModal_active__36Haq",inner:"UploadModal_inner__3Kp__"}},55:function(e,t,a){e.exports={title:"UploadForm_title__3TYAS",btn:"UploadForm_btn__2j8Wb",uploadTitle:"UploadForm_uploadTitle__TUpZY"}},70:function(e,t,a){e.exports={wrapper:"PlayerControls_wrapper__1B9_M",controls:"PlayerControls_controls__1Paow",musicImage:"PlayerControls_musicImage__25dQk",controlsBox:"PlayerControls_controlsBox__2-GwW"}},79:function(e,t,a){e.exports={player:"Player_player__3VJ35",musicImage:"Player_musicImage__1w-aM"}},80:function(e,t,a){e.exports={box:"PlayerVolume_box__ztdcc",title:"PlayerVolume_title__1wp3r"}},81:function(e,t,a){e.exports={loadingWrapper:"Loading_loadingWrapper__2Lhoj",loading:"Loading_loading__-v3sh",load:"Loading_load__1ige4"}},92:function(e,t,a){e.exports={box:"PlayerMusicImage_box__1uK4L"}},93:function(e,t,a){e.exports={input:"FormInput_input__Owuwx"}}},[[128,1,2]]]);
//# sourceMappingURL=main.c99d72b9.chunk.js.map