var re=Object.defineProperty,ae=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var R=(o,t,n)=>t in o?re(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,w=(o,t)=>{for(var n in t||(t={}))j.call(t,n)&&R(o,n,t[n]);if(T)for(var n of T(t))O.call(t,n)&&R(o,n,t[n]);return o},E=(o,t)=>ae(o,ce(t));var B=(o,t)=>{var n={};for(var s in o)j.call(o,s)&&t.indexOf(s)<0&&(n[s]=o[s]);if(o!=null&&T)for(var s of T(o))t.indexOf(s)<0&&O.call(o,s)&&(n[s]=o[s]);return n};import{j as U,c as y,g as te,a as ie,I as de,A as ue,m as k,u as x,r as m,b as me,d as _e,e as oe,F as A,f as pe,h as he,i as fe,k as ye,l as ve,R as ge,n as xe,o as be}from"./vendor.402c6bd1.js";const ke=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}};ke();const Ne="_playlist_11scu_1",$e="_title_11scu_23",Te="_head_11scu_33",we="_uploadModal_11scu_45",Be="_btn_11scu_57";var C={playlist:Ne,title:$e,head:Te,uploadModal:we,btn:Be};const Ce="_title_xynlk_1";var Ie={title:Ce};const e=U.exports.jsx,c=U.exports.jsxs,z=U.exports.Fragment,Se=()=>e("div",{children:e("p",{className:Ie.title,children:"Connection Error"})}),Ae="_block_cfywl_1",Me="_center_cfywl_9";var K={block:Ae,center:Me};const G=l=>{var r=l,{children:o,className:t,childsCenter:n}=r,s=B(r,["children","className","childsCenter"]);return e("div",E(w({className:y(K.block,t,{[K.center]:n})},s),{children:o}))},Pe="_loading_1odma_1",Ee="_load_1odma_1";var Le={loading:Pe,load:Ee};const ne=({className:o})=>e("div",{className:y(Le.loading,o)}),V=te`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,Fe="_tracksBlock_diz2w_1";var qe={tracksBlock:Fe};const Ue="_track_dy45d_1",Ve="_info_dy45d_41",De="_innerBox_dy45d_61",Re="_text_dy45d_69",je="_active_dy45d_89",Oe="_trackBox_dy45d_107";var _={track:Ue,info:Ve,innerBox:De,text:Re,active:je,trackBox:Oe};const ze=({title:o,active:t,subtitle:n,onClick:s})=>c("button",{onClick:()=>s(),className:y(_.track,{[_.active]:t}),children:[e("div",{className:_.trackBox}),c("div",{className:_.info,children:[e("div",{className:_.innerBox,children:e("h2",{className:_.text,children:o})}),e("div",{className:_.innerBox,children:e("h3",{className:_.text,children:n})})]})]}),f=k(null),L=k(!1),Q=k(1),F=k(0),H=k(0),Ke="https://eyes-closed-server.herokuapp.com/graphql",Ge=ie({uri:Ke}),Qe=new de,He=new ue({link:Ge,cache:Qe}),Je=({data:o})=>{const t=x(f),n=s=>()=>f(s);return e("ul",{className:qe.tracksBlock,children:o.map(s=>e("li",{children:e(ze,{active:s.id===(t==null?void 0:t.id),onClick:n(s),title:s.title,subtitle:s.author})},s.id))})},We="_button_ptj0d_1";var Xe={button:We};const se=s=>{var l=s,{children:o,className:t}=l,n=B(l,["children","className"]);return e("button",E(w({className:y(Xe.button,t)},n),{children:o}))},Ye="__lock_rqvxe_1",Ze="_modal_rqvxe_9",et="_overlay_rqvxe_39";var I={_lock:Ye,modal:Ze,overlay:et};const J=document.getElementById("modal"),tt=({className:o,children:t,open:n,onClose:s})=>(m.exports.useEffect(()=>{document.body.classList.add(I._lock)},[]),m.exports.useEffect(()=>{document.body.classList.toggle(I._lock)},[n]),!n||!J?e(z,{}):me.exports.createPortal(c(z,{children:[e("div",{onClick:s,className:I.overlay}),e("div",{className:y(I.modal,o),children:t})]}),J)),ot="_form_1mtor_1",nt="_btn_1mtor_15",st="_uploadTitle_1mtor_27";var q={form:ot,btn:nt,uploadTitle:st};const lt=te`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,rt="_input_uv6sf_1";var at={input:rt};const W=m.exports.memo(r=>{var a=r,{inputState:o,setInputState:t,labelText:n,className:s}=a,l=B(a,["inputState","setInputState","labelText","className"]);return c("label",{children:[e("h3",{children:n}),e("input",w({required:!0,className:y(at.input,s),value:o,onChange:u=>t(u.target.value),type:"text"},l))]})}),ct="_block_r92fe_1",it="_title_r92fe_17";var X={block:ct,title:it};const dt=({title:o="Uploading track. Please wait.",className:t})=>c("div",{className:y(X.block,t),children:[e("p",{className:X.title,children:o}),e(ne,{})]}),ut=({onSubmit:o})=>{const[t,n]=m.exports.useState(null),[s,l]=m.exports.useState(""),[r,a]=m.exports.useState(""),[u,{loading:M}]=_e(lt),N=p=>{var $;const h=($=p.target.files)==null?void 0:$[0];h&&h.type.includes("audio/")?n(h):alert("Select audio/mpeg file")},P=async p=>{p.preventDefault();try{await u({variables:{title:s,author:r,file:t},refetchQueries:[{query:V}]}),o(),a(""),l("")}catch(h){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",h)}};return M?e(dt,{}):c("form",{className:q.form,action:"",onSubmit:P,children:[e("h1",{children:"Upload Track"}),e(W,{inputState:r,setInputState:a,labelText:"Author"}),e(W,{inputState:s,setInputState:l,labelText:"Title"}),c("label",{children:[e("h1",{className:q.uploadTitle,children:"Upload audio File"}),e("input",{required:!0,type:"file",accept:"audio/*",onChange:N})]}),e(se,{className:q.btn,type:"submit",children:"Upload Track"})]})},mt=()=>{const{data:o,loading:t,error:n}=oe(V),[s,l]=m.exports.useState(!1),r=o==null?void 0:o.getAllTracks;if(n)return e(G,{children:e(Se,{})});if(t||!r)return e(G,{childsCenter:!0,children:e(ne,{})});const a=()=>()=>l(!0),u=()=>()=>l(!1);return c("section",{className:C.playlist,children:[c("div",{className:C.head,children:[e("h1",{className:C.title,children:`Playlist: ${r.length}`}),e(se,{onClick:a(),children:"Add new track"})]}),e(Je,{data:r}),e(tt,{className:C.uploadModal,open:s,onClose:u(),children:e(ut,{onSubmit:u()})})]})},_t="_player_1glm3_1",pt="_musicImage_1glm3_57";var Y={player:_t,musicImage:pt};const ht="_wrapper_sfmsf_1",ft="_rewindControls_sfmsf_19",yt="_musicImage_sfmsf_29",vt="_button_sfmsf_37";var v={wrapper:ht,rewindControls:ft,musicImage:yt,button:vt};const gt="_box_dmcht_1";var xt={box:gt};const le=()=>e("div",{className:xt.box,children:e(A,{style:{fontSize:"1.7rem"},icon:pe,color:"black"})}),bt=({toggleAudio:o,nextTrack:t,prevTrack:n,playing:s})=>c("div",{className:v.wrapper,children:[e("div",{className:v.musicImage,children:e(le,{})}),e("button",{className:v.button,onClick:()=>o(),children:e(A,{size:"3x",icon:s?he:fe,color:"black"})}),c("div",{className:v.rewindControls,children:[e("button",{className:v.button,onClick:()=>n(),children:e(A,{size:"2x",icon:ye,color:"black"})}),e("button",{className:v.button,onClick:()=>t(),children:e(A,{size:"2x",icon:ve,color:"black"})})]})]}),kt="_box_e863m_1",Nt="_title_e863m_17";var Z={box:kt,title:Nt};const $t=({volumeState:o,handleVolume:t})=>c("div",{className:Z.box,children:[c("p",{className:Z.title,children:["Volume: ",Math.round(o*100),"%"]}),e("input",{className:"clickable",type:"range",value:Math.round(o*100),onChange:n=>t(n)})]}),ee=o=>{const t=Math.floor(o/60),n=Math.floor(o%60),s=t<10?`0${t}`:`${t}`,l=n<10?`0${n}`:`${n}`;return`${s}:${l}`},Tt="_infoInnerBox_1xn2v_1",wt="_title_1xn2v_13",Bt="_progressBar_1xn2v_29",Ct="_info_1xn2v_1";var g={infoInnerBox:Tt,title:wt,progressBar:Bt,info:Ct};const It=({track:o,duration:t,currentTime:n,handleProgress:s,canChangeTime:l})=>c("div",{className:g.info,children:[c("div",{className:g.infoInnerBox,children:[e("h2",{className:g.title,children:o==null?void 0:o.title}),e("p",{children:ee(t)})]}),c("div",{className:g.infoInnerBox,children:[e("h3",{className:g.title,children:o==null?void 0:o.author}),e("p",{children:ee(n)})]}),e("input",{className:g.progressBar,type:"range",disabled:!l,onChange:s,value:t?Math.round(n*100/t):0})]});let d=new Audio,S=!0;const St=200,At=()=>{const o=x(H),t=x(f),n=x(F),s=x(L),l=x(Q),{data:r}=oe(V),a=r==null?void 0:r.getAllTracks,u=i=>{if(!!d.src)switch(i.code){case"Space":i.preventDefault(),p();break}};m.exports.useEffect(()=>(window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[]);const M=()=>{if(!a||!t)return;const i=a.indexOf(t);f(i===0?a[a.length-1]:a[i-1])},N=()=>{if(!a||!t)return;const i=a.indexOf(t);i===a.length-1?f(a[0]):f(a[i+1])},P=()=>N();m.exports.useEffect(()=>{t&&(d.src=t.src,d.ontimeupdate=()=>F(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{S=!0},St),H(d.duration)},d.onended=()=>{S=!1,P()},p())},[t]);const p=async()=>{if(d.paused){L(!0);try{await d.play()}catch(i){console.log(i)}}else L(!1),d.pause()},h=i=>{const D=+i.target.value;if(S){const b=D*o/100;d.currentTime=b,F(b)}},$=i=>{const b=+i.target.value/100;Q(b),d.volume=b};return t?c("div",{className:Y.player,children:[e(bt,{toggleAudio:p,nextTrack:N,prevTrack:M,playing:s}),e("div",{className:Y.musicImage,children:e(le,{})}),e(It,{track:t,duration:o,currentTime:n,handleProgress:h,canChangeTime:S}),e($t,{volumeState:l,handleVolume:$})]}):null},Mt=()=>c("div",{className:"container",children:[e(At,{}),e(mt,{})]});ge.render(e(xe.StrictMode,{children:e(be,{client:He,children:e(Mt,{})})}),document.getElementById("root"));
