var re=Object.defineProperty,le=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var U=(n,t,o)=>t in n?re(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,w=(n,t)=>{for(var o in t||(t={}))D.call(t,o)&&U(n,o,t[o]);if($)for(var o of $(t))R.call(t,o)&&U(n,o,t[o]);return n},P=(n,t)=>le(n,ae(t));var B=(n,t)=>{var o={};for(var s in n)D.call(n,s)&&t.indexOf(s)<0&&(o[s]=n[s]);if(n!=null&&$)for(var s of $(n))t.indexOf(s)<0&&R.call(n,s)&&(o[s]=n[s]);return o};import{j as q,c as b,g as Z,a as ce,I as ie,A as de,m as N,u as x,r as ue,b as f,d as me,e as ee,F as S,f as pe,h as _e,i as he,k as fe,l as ge,R as ye,n as ve,o as xe}from"./vendor.07c8edb2.js";const ke=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=o(r);fetch(r.href,l)}};ke();const be="_playlist_dy7d3_1",Ne="_title_dy7d3_23",Te="_head_dy7d3_33",$e="_btn_dy7d3_45";var E={playlist:be,title:Ne,head:Te,btn:$e};const we="_title_xynlk_1";var Be={title:we};const e=q.exports.jsx,c=q.exports.jsxs,V=q.exports.Fragment,Ce=()=>e("div",{children:e("p",{className:Be.title,children:"Connection Error"})}),Ie="_block_11qbe_1";var Se={block:Ie};const j=s=>{var r=s,{children:n,className:t}=r,o=B(r,["children","className"]);return e("div",P(w({className:b(Se.block,t)},o),{children:n}))},Ae="_loadingWrapper_flrcn_1",Me="_loading_flrcn_1",Pe="_load_flrcn_1";var O={loadingWrapper:Ae,loading:Me,load:Pe};const te=()=>e("div",{className:O.loadingWrapper,children:e("div",{className:O.loading})}),ne=Z`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,Ee="_tracksBlock_diz2w_1";var Fe={tracksBlock:Ee};const Le="_track_dy45d_1",Ve="_info_dy45d_41",qe="_innerBox_dy45d_61",ze="_text_dy45d_69",Ue="_active_dy45d_89",De="_trackBox_dy45d_107";var p={track:Le,info:Ve,innerBox:qe,text:ze,active:Ue,trackBox:De};const Re=({title:n,active:t,subtitle:o,onClick:s})=>c("button",{onClick:()=>s(),className:b(p.track,{[p.active]:t}),children:[e("div",{className:p.trackBox}),c("div",{className:p.info,children:[e("div",{className:p.innerBox,children:e("h2",{className:p.text,children:n})}),e("div",{className:p.innerBox,children:e("h3",{className:p.text,children:o})})]})]}),h=N(null),F=N(!1),K=N(1),L=N(0),W=N(0),je="https://eyes-closed-server.herokuapp.com/graphql",Oe=ce({uri:je}),Ke=new ie,We=new de({link:Oe,cache:Ke}),Ge=({data:n})=>{const t=x(h),o=s=>()=>h(s);return e("ul",{className:Fe.tracksBlock,children:n.map(s=>e("li",{children:e(Re,{active:s.id===(t==null?void 0:t.id),onClick:o(s),title:s.title,subtitle:s.author})},s.id))})},He="_button_ptj0d_1";var Qe={button:He};const oe=s=>{var r=s,{children:n,className:t}=r,o=B(r,["children","className"]);return e("button",P(w({className:b(Qe.button,t)},o),{children:n}))},Je="_modal_1pv5q_1",Xe="_overlay_1pv5q_27";var G={modal:Je,overlay:Xe};const H=document.getElementById("modal"),Ye=({className:n,children:t,open:o,onClose:s})=>!o||!H?e(V,{}):ue.exports.createPortal(c(V,{children:[e("div",{onClick:s,className:G.overlay}),e("div",{className:b(G.modal,n),children:t})]}),H),Ze="_form_glkez_1",et="_btn_glkez_19",tt="_uploadTitle_glkez_31",nt="_loadingTitle_glkez_43";var C={form:Ze,btn:et,uploadTitle:tt,loadingTitle:nt};const ot=Z`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,st="_input_uv6sf_1";var rt={input:st};const Q=f.exports.memo(l=>{var a=l,{inputState:n,setInputState:t,labelText:o,className:s}=a,r=B(a,["inputState","setInputState","labelText","className"]);return c("label",{children:[e("h3",{children:o}),e("input",w({required:!0,className:b(rt.input,s),value:n,onChange:m=>t(m.target.value),type:"text"},r))]})}),lt=({onSubmit:n})=>{const[t,o]=f.exports.useState(null),[s,r]=f.exports.useState(""),[l,a]=f.exports.useState(""),[m,{loading:A}]=me(ot),T=_=>{var g;const u=(g=_.target.files)==null?void 0:g[0];u&&u.type.includes("audio/")?o(u):alert("Select audio/mpeg file")},M=async _=>{_.preventDefault();try{const{data:u}=await m({variables:{title:s,author:l,file:t}}),g=u==null?void 0:u.addTrack;console.log(g),n(),a(""),r("")}catch(u){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",u)}};return A?c(V,{children:[e("p",{className:C.loadingTitle,children:"Uploading track. Please wait."}),e(te,{})]}):c("form",{className:C.form,action:"",onSubmit:M,children:[e("h1",{children:"Upload Track"}),e(Q,{inputState:l,setInputState:a,labelText:"Author"}),e(Q,{inputState:s,setInputState:r,labelText:"Title"}),c("label",{children:[e("h1",{className:C.uploadTitle,children:"Upload audio File"}),e("input",{required:!0,type:"file",accept:"audio/*",onChange:T})]}),e(oe,{className:C.btn,type:"submit",children:"Upload Track"})]})},at=()=>{const{data:n,loading:t,error:o}=ee(ne),[s,r]=f.exports.useState(!1),l=n==null?void 0:n.getAllTracks;if(o)return e(j,{children:e(Ce,{})});if(t||!l)return e(j,{children:e(te,{})});const a=()=>()=>r(!0),m=()=>()=>r(!1);return c("section",{className:E.playlist,children:[c("div",{className:E.head,children:[e("h1",{className:E.title,children:`Playlist: ${l.length}`}),e(oe,{onClick:a(),children:"Add new track"})]}),e(Ge,{data:l}),e(Ye,{open:s,onClose:m(),children:e(lt,{onSubmit:m()})})]})},ct="_player_1ro2p_1",it="_musicImage_1ro2p_59";var J={player:ct,musicImage:it};const dt="_wrapper_sfmsf_1",ut="_rewindControls_sfmsf_19",mt="_musicImage_sfmsf_29",pt="_button_sfmsf_37";var y={wrapper:dt,rewindControls:ut,musicImage:mt,button:pt};const _t="_box_dmcht_1";var ht={box:_t};const se=()=>e("div",{className:ht.box,children:e(S,{style:{fontSize:"1.7rem"},icon:pe,color:"black"})}),ft=({toggleAudio:n,nextTrack:t,prevTrack:o,playing:s})=>c("div",{className:y.wrapper,children:[e("div",{className:y.musicImage,children:e(se,{})}),e("button",{className:y.button,onClick:()=>n(),children:e(S,{size:"3x",icon:s?_e:he,color:"black"})}),c("div",{className:y.rewindControls,children:[e("button",{className:y.button,onClick:()=>o(),children:e(S,{size:"2x",icon:fe,color:"black"})}),e("button",{className:y.button,onClick:()=>t(),children:e(S,{size:"2x",icon:ge,color:"black"})})]})]}),gt="_box_e863m_1",yt="_title_e863m_17";var X={box:gt,title:yt};const vt=({volumeState:n,handleVolume:t})=>c("div",{className:X.box,children:[c("p",{className:X.title,children:["Volume: ",Math.round(n*100),"%"]}),e("input",{className:"clickable",type:"range",value:Math.round(n*100),onChange:o=>t(o)})]}),Y=n=>{const t=Math.floor(n/60),o=Math.floor(n%60),s=t<10?`0${t}`:`${t}`,r=o<10?`0${o}`:`${o}`;return`${s}:${r}`},xt="_infoInnerBox_1xn2v_1",kt="_title_1xn2v_13",bt="_progressBar_1xn2v_29",Nt="_info_1xn2v_1";var v={infoInnerBox:xt,title:kt,progressBar:bt,info:Nt};const Tt=({track:n,duration:t,currentTime:o,handleProgress:s,canChangeTime:r})=>c("div",{className:v.info,children:[c("div",{className:v.infoInnerBox,children:[e("h2",{className:v.title,children:n==null?void 0:n.title}),e("p",{children:Y(t)})]}),c("div",{className:v.infoInnerBox,children:[e("h3",{className:v.title,children:n==null?void 0:n.author}),e("p",{children:Y(o)})]}),e("input",{className:v.progressBar,type:"range",disabled:!r,onChange:s,value:t?Math.round(o*100/t):0})]});let d=new Audio,I=!0;const $t=200,wt=()=>{const n=x(W),t=x(h),o=x(L),s=x(F),r=x(K),{data:l}=ee(ne),a=l==null?void 0:l.getAllTracks,m=i=>{if(!!d.src)switch(i.code){case"Space":i.preventDefault(),_();break}};f.exports.useEffect(()=>(window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)),[]);const A=()=>{if(!a||!t)return;const i=a.indexOf(t);h(i===0?a[a.length-1]:a[i-1])},T=()=>{if(!a||!t)return;const i=a.indexOf(t);i===a.length-1?h(a[0]):h(a[i+1])},M=()=>T();f.exports.useEffect(()=>{t&&(d.src=t.src,d.ontimeupdate=()=>L(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{I=!0},$t),W(d.duration)},d.onended=()=>{I=!1,M()},_())},[t]);const _=async()=>{if(d.paused){F(!0);try{await d.play()}catch(i){console.log(i)}}else F(!1),d.pause()},u=i=>{const z=+i.target.value;if(I){const k=z*n/100;d.currentTime=k,L(k)}},g=i=>{const k=+i.target.value/100;K(k),d.volume=k};return t?c("div",{className:J.player,children:[e(ft,{toggleAudio:_,nextTrack:T,prevTrack:A,playing:s}),e("div",{className:J.musicImage,children:e(se,{})}),e(Tt,{track:t,duration:n,currentTime:o,handleProgress:u,canChangeTime:I}),e(vt,{volumeState:r,handleVolume:g})]}):null},Bt=()=>c("div",{className:"container",children:[e(wt,{}),e(at,{})]});ye.render(e(ve.StrictMode,{children:e(xe,{client:We,children:e(Bt,{})})}),document.getElementById("root"));
