var te=Object.defineProperty,ne=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var V=(n,e,s)=>e in n?te(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,T=(n,e)=>{for(var s in e||(e={}))E.call(e,s)&&V(n,s,e[s]);if(N)for(var s of N(e))O.call(e,s)&&V(n,s,e[s]);return n},P=(n,e)=>ne(n,se(e));var $=(n,e)=>{var s={};for(var a in n)E.call(n,a)&&e.indexOf(a)<0&&(s[a]=n[a]);if(n!=null&&N)for(var a of N(n))e.indexOf(a)<0&&O.call(n,a)&&(s[a]=n[a]);return s};import{g as Q,j as U,r as _,c as S,u as ae,a as oe,I as le,A as re,m as k,b as f,d as J,F as I,f as ce,e as ie,h as de,i as ue,k as pe,R as me,l as _e,n as he}from"./vendor.db5403e8.js";const fe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}};fe();const ge="_playlist_dy7d3_1",ye="_title_dy7d3_23",ve="_head_dy7d3_33",ke="_btn_dy7d3_45";var M={playlist:ge,title:ye,head:ve,btn:ke};const xe="_form_bhkkl_1",be="_btn_bhkkl_13",Ne="_uploadTitle_bhkkl_25",Te="_loadingTitle_bhkkl_37";var w={form:xe,btn:be,uploadTitle:Ne,loadingTitle:Te};const $e=Q`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,we="_input_uv6sf_1";var Ce={input:we};const t=U.exports.jsx,c=U.exports.jsxs,Be=U.exports.Fragment,R=_.exports.memo(l=>{var r=l,{inputState:n,setInputState:e,labelText:s,className:a}=r,o=$(r,["inputState","setInputState","labelText","className"]);return c("label",{children:[t("h3",{children:s}),t("input",T({required:!0,className:S(Ce.input,a),value:n,onChange:g=>e(g.target.value),type:"text"},o))]})}),Ie="_loadingWrapper_flrcn_1",Se="_loading_flrcn_1",Ae="_load_flrcn_1";var j={loadingWrapper:Ie,loading:Se,load:Ae};const X=()=>t("div",{className:j.loadingWrapper,children:t("div",{className:j.loading})}),Pe="_button_1u6fa_1";var Me={button:Pe};const Y=a=>{var o=a,{children:n,className:e}=o,s=$(o,["children","className"]);return t("button",P(T({className:S(Me.button,e)},s),{children:n}))},Fe=function({setModal:n}){const[e,s]=_.exports.useState(null),[a,o]=_.exports.useState(""),[l,r]=_.exports.useState(""),[g,{loading:x}]=ae($e),A=async y=>{const u=await y.target.files[0];u.type.includes("audio/")?s(u):alert("select audio/mpeg file")},b=async y=>{y.preventDefault();try{const{data:{addTrack:u}}=await g({variables:{title:a,author:l,file:e}});console.log(u),n(!1),r(""),o("")}catch(u){alert("Failed to upload track to server"),console.log("Upload failed: ",u)}};return x?c(Be,{children:[t("p",{className:w.loadingTitle,children:"Uploading track. Please wait."}),t(X,{})]}):c("form",{className:w.form,action:"",onSubmit:b,children:[t("h1",{children:"Upload Track"}),t(R,{inputState:l,setInputState:r,labelText:"Author"}),t(R,{inputState:a,setInputState:o,labelText:"Title"}),c("label",{children:[t("h1",{className:w.uploadTitle,children:"Upload audio File"}),t("input",{required:!0,type:"file",accept:"audio/*",onChange:A})]}),t(Y,{className:w.btn,type:"submit",children:"UPLOAD TRACK"})]})},qe="_wrapper_1fdel_1",Le="_active_1fdel_25",Ue="_inner_1fdel_37";var C={wrapper:qe,active:Le,inner:Ue};const Ve=_.exports.memo(({modal:n,setModal:e})=>t("div",{onClick:()=>e(!n),className:n?`${C.wrapper} ${C.active}`:C.wrapper,children:t("div",{onClick:s=>s.stopPropagation(),className:C.inner,children:t(Fe,{setModal:e})})})),Ee="_title_xynlk_1";var Oe={title:Ee};const Re=()=>t("div",{children:t("p",{className:Oe.title,children:"Connection Error"})}),je="_block_11qbe_1";var De={block:je};const D=a=>{var o=a,{children:n,className:e}=o,s=$(o,["children","className"]);return t("div",P(T({className:S(De.block,e)},s),{children:n}))},Z=Q`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,ze="_tracksBlock_diz2w_1";var Ke={tracksBlock:ze};const We="_track_16aoq_1",Ge="_info_16aoq_39",He="_innerBox_16aoq_59",Qe="_text_16aoq_67",Je="_active_16aoq_87",Xe="_trackBox_16aoq_105";var p={track:We,info:Ge,innerBox:He,text:Qe,active:Je,trackBox:Xe};const Ye=({title:n,active:e,subtitle:s,onClick:a})=>c("button",{onClick:()=>a(),className:S(p.track,{[p.active]:e}),children:[t("div",{className:p.trackBox}),c("div",{className:p.info,children:[t("div",{className:p.innerBox,children:t("h2",{className:p.text,children:n})}),t("div",{className:p.innerBox,children:t("h3",{className:p.text,children:s})})]})]}),m=k(null),F=k(!1),z=k(1),q=k(0),K=k(0),Ze="https://eyes-closed-server.herokuapp.com/graphql",et=oe({uri:Ze}),tt=new le,nt=new re({link:et,cache:tt}),st=({data:n})=>{const e=f(m),s=a=>()=>m(a);return t("ul",{className:Ke.tracksBlock,children:n.map(a=>t("li",{children:t(Ye,{active:a.id===(e==null?void 0:e.id),onClick:s(a),title:a.title,subtitle:a.author})},a.id))})},at=()=>{const{data:n,loading:e,error:s}=J(Z),[a,o]=_.exports.useState(!1),l=n==null?void 0:n.getAllTracks;if(s)return t(D,{children:t(Re,{})});if(e||!l)return t(D,{children:t(X,{})});const r=()=>()=>o(!a);return c("section",{className:M.playlist,children:[c("div",{className:M.head,children:[t("h1",{className:M.title,children:`Playlist: ${l.length}`}),t(Y,{onClick:r(),children:"Add new track"})]}),t(st,{data:l}),t(Ve,{modal:a,setModal:o})]})},ot="_player_vse6p_1",lt="_musicImage_vse6p_59";var W={player:ot,musicImage:lt};const rt="_wrapper_rh7xg_1",ct="_rewindControls_rh7xg_19",it="_musicImage_rh7xg_29";var L={wrapper:rt,rewindControls:ct,musicImage:it};const dt="_box_dmcht_1";var ut={box:dt};const ee=()=>t("div",{className:ut.box,children:t(I,{style:{fontSize:"1.7rem"},icon:ce,color:"black"})}),pt=({toggleAudio:n,nextTrack:e,prevTrack:s,playing:a})=>c("div",{className:L.wrapper,children:[t("div",{className:L.musicImage,children:t(ee,{})}),t(I,{className:"clickable",onClick:()=>n(),style:{fontSize:"2.5rem"},icon:a?ie:de,color:"black"}),c("div",{className:L.rewindControls,children:[t(I,{className:"clickable",style:{fontSize:"1.5rem"},icon:ue,color:"black",onClick:()=>s()}),t(I,{className:"clickable",style:{fontSize:"1.5rem"},icon:pe,color:"black",onClick:()=>e()})]})]}),mt="_box_rwxli_1",_t="_title_rwxli_17";var G={box:mt,title:_t};const ht=({volumeState:n,handleVolume:e})=>c("div",{className:G.box,children:[c("p",{className:G.title,children:["Volume: ",Math.round(n*100),"%"]}),t("input",{className:"clickable",type:"range",value:Math.round(n*100),onChange:s=>e(s)})]}),H=n=>{const e=Math.floor(n/60),s=Math.floor(n%60),a=e<10?`0${e}`:`${e}`,o=s<10?`0${s}`:`${s}`;return`${a}:${o}`},ft="_infoInnerBox_e4w1s_1",gt="_title_e4w1s_13",yt="_progressBar_e4w1s_29",vt="_info_e4w1s_1";var h={infoInnerBox:ft,title:gt,progressBar:yt,info:vt};const kt=({track:n,duration:e,currentTime:s,handleProgress:a,canChangeTime:o})=>c("div",{className:h.info,children:[c("div",{className:h.infoInnerBox,children:[t("h2",{className:h.title,children:n==null?void 0:n.title}),t("p",{children:H(e)})]}),c("div",{className:h.infoInnerBox,children:[t("h3",{className:h.title,children:n==null?void 0:n.author}),t("p",{children:H(s)})]}),t("input",{className:h.progressBar,type:"range",disabled:!o,onChange:a,value:e?Math.round(s*100/e):0})]});let d=new Audio,B=!0;const xt=200,bt=()=>{const n=f(K),e=f(m),s=f(q),a=f(F),o=f(z),{data:l}=J(Z),r=l==null?void 0:l.getAllTracks,g=()=>{if(!r||!e)return;const i=r.indexOf(e);m(i===0?r[r.length-1]:r[i-1])},x=()=>{if(!r||!e)return;const i=r.indexOf(e);i===r.length-1?m(r[0]):m(r[i+1])},A=()=>x();_.exports.useEffect(()=>{e&&(d.src=e.src,d.ontimeupdate=()=>q(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{B=!0},xt),K(d.duration)},d.onended=()=>{B=!1,A()},b())},[e]);const b=async()=>{if(d.paused){F(!0);try{await d.play()}catch(i){console.log(i)}}else F(!1),d.pause()},y=i=>{if(B){const v=i.target.value*n/100;d.currentTime=v,q(v)}},u=i=>{const v=i.target.value/100;z(v),d.volume=v};return e?c("div",{className:W.player,children:[t(pt,{toggleAudio:b,nextTrack:x,prevTrack:g,playing:a}),t("div",{className:W.musicImage,children:t(ee,{})}),t(kt,{track:e,duration:n,currentTime:s,handleProgress:y,canChangeTime:B}),t(ht,{volumeState:o,handleVolume:u})]}):null},Nt=()=>c("div",{className:"container",children:[t(bt,{}),t(at,{})]});me.render(t(_e.StrictMode,{children:t(he,{client:nt,children:t(Nt,{})})}),document.getElementById("root"));
