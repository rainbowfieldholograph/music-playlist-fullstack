var re=Object.defineProperty,ae=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var j=(e,o,n)=>o in e?re(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,x=(e,o)=>{for(var n in o||(o={}))q.call(o,n)&&j(e,n,o[n]);if(C)for(var n of C(o))O.call(o,n)&&j(e,n,o[n]);return e},B=(e,o)=>ae(e,ce(o));var N=(e,o)=>{var n={};for(var s in e)q.call(e,s)&&o.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&C)for(var s of C(e))o.indexOf(s)<0&&O.call(e,s)&&(n[s]=e[s]);return n};import{j as V,c as y,g as te,a as ie,I as de,A as ue,m as $,u as k,r as m,b as me,f as _e,d as pe,e as oe,F as M,h as he,i as fe,k as ye,l as ve,n as ge,R as ke,o as be,p as xe}from"./vendor.d5639c3c.js";const Ne=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}};Ne();const $e="_playlist_11scu_1",Te="_title_11scu_23",we="_head_11scu_33",Ce="_uploadModal_11scu_45",Be="_btn_11scu_57";var I={playlist:$e,title:Te,head:we,uploadModal:Ce,btn:Be};const Ie="_title_xynlk_1";var Se={title:Ie};const t=V.exports.jsx,c=V.exports.jsxs,Ae=V.exports.Fragment,Me=n=>{var s=n,{className:e}=s,o=N(s,["className"]);return t("div",B(x({className:e},o),{children:t("p",{className:Se.title,children:"Connection Error"})}))},Pe="_block_cfywl_1",Ee="_center_cfywl_9";var z={block:Pe,center:Ee};const K=l=>{var r=l,{children:e,className:o,childsCenter:n}=r,s=N(r,["children","className","childsCenter"]);return t("div",B(x({className:y(z.block,o,{[z.center]:n})},s),{children:e}))},Le="_loading_clven_1",Fe="_load_clven_1";var Ue={loading:Le,load:Fe};const ne=({className:e})=>t("div",{className:y(Ue.loading,e)}),R=te`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,Ve="_tracksBlock_diz2w_1";var Re={tracksBlock:Ve};const De="_track_dy45d_1",je="_info_dy45d_41",qe="_innerBox_dy45d_61",Oe="_text_dy45d_69",ze="_active_dy45d_89",Ke="_trackBox_dy45d_107";var _={track:De,info:je,innerBox:qe,text:Oe,active:ze,trackBox:Ke};const Ge=({title:e,active:o,subtitle:n,onClick:s})=>c("button",{onClick:()=>s(),className:y(_.track,{[_.active]:o}),children:[t("div",{className:_.trackBox}),c("div",{className:_.info,children:[t("div",{className:_.innerBox,children:t("h2",{className:_.text,children:e})}),t("div",{className:_.innerBox,children:t("h3",{className:_.text,children:n})})]})]}),f=$(null),L=$(!1),G=$(.5),F=$(0),Q=$(0),Qe="https://eyes-closed-server.herokuapp.com/graphql",He=ie({uri:Qe}),Je=new de,We=new ue({link:He,cache:Je}),Xe=({data:e})=>{const o=k(f),n=s=>()=>f(s);return t("ul",{className:Re.tracksBlock,children:e.map(s=>t("li",{children:t(Ge,{active:s.id===(o==null?void 0:o.id),onClick:n(s),title:s.title,subtitle:s.author})},s.id))})},Ye="_button_ptj0d_1";var Ze={button:Ye};const se=s=>{var l=s,{children:e,className:o}=l,n=N(l,["children","className"]);return t("button",B(x({className:y(Ze.button,o)},n),{children:e}))},et="__lock_1up8e_1",tt="_modal_1up8e_9",ot="_overlay_1up8e_41";var S={_lock:et,modal:tt,overlay:ot};const H=document.getElementById("modal"),nt=({className:e,children:o,open:n,onClose:s})=>(m.exports.useEffect(()=>{document.body.classList.add(S._lock)},[]),m.exports.useEffect(()=>{document.body.classList.toggle(S._lock)},[n]),!n||!H?t(Ae,{}):me.exports.createPortal(t(_e,{children:t("div",{onClick:s,className:S.overlay,children:t("div",{onClick:l=>l.stopPropagation(),role:"dialog",className:y(S.modal,e),children:o})})}),H)),st="_form_1mtor_1",lt="_btn_1mtor_15",rt="_uploadTitle_1mtor_27";var U={form:st,btn:lt,uploadTitle:rt};const at=te`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,ct="_input_uv6sf_1";var it={input:ct};const J=m.exports.memo(r=>{var a=r,{inputState:e,setInputState:o,labelText:n,className:s}=a,l=N(a,["inputState","setInputState","labelText","className"]);return c("label",{children:[t("h3",{children:n}),t("input",x({required:!0,className:y(it.input,s),value:e,onChange:u=>o(u.target.value),type:"text"},l))]})}),dt="_block_r92fe_1",ut="_title_r92fe_17";var W={block:dt,title:ut};const mt=({title:e="Uploading track. Please wait.",className:o})=>c("div",{className:y(W.block,o),children:[t("p",{className:W.title,children:e}),t(ne,{})]}),_t=({onSubmit:e})=>{const[o,n]=m.exports.useState(null),[s,l]=m.exports.useState(""),[r,a]=m.exports.useState(""),[u,{loading:P}]=pe(at),T=p=>{var w;const h=(w=p.target.files)==null?void 0:w[0];h&&h.type.includes("audio/")?n(h):alert("Select audio/mpeg file")},E=async p=>{p.preventDefault();try{await u({variables:{title:s,author:r,file:o},refetchQueries:[{query:R}]}),e(),a(""),l("")}catch(h){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",h)}};return P?t(mt,{}):c("form",{className:U.form,action:"",onSubmit:E,children:[t("h1",{children:"Upload Track"}),t(J,{inputState:r,setInputState:a,labelText:"Author"}),t(J,{inputState:s,setInputState:l,labelText:"Title"}),c("label",{children:[t("h1",{className:U.uploadTitle,children:"Upload audio File"}),t("input",{required:!0,type:"file",accept:"audio/*",onChange:T})]}),t(se,{className:U.btn,type:"submit",children:"Upload Track"})]})},pt=()=>{const{data:e,loading:o,error:n}=oe(R),[s,l]=m.exports.useState(!1),r=e==null?void 0:e.getAllTracks;if(n)return t(K,{children:t(Me,{})});if(o||!r)return t(K,{childsCenter:!0,children:t(ne,{})});const a=()=>()=>l(!0),u=()=>()=>l(!1);return c("section",{className:I.playlist,children:[c("div",{className:I.head,children:[t("h1",{className:I.title,children:`Playlist: ${r.length}`}),t(se,{onClick:a(),children:"Add new track"})]}),t(Xe,{data:r}),t(nt,{className:I.uploadModal,open:s,onClose:u(),children:t(_t,{onSubmit:u()})})]})},ht="_player_1s3k7_1",ft="_musicImage_1s3k7_59";var X={player:ht,musicImage:ft};const yt="_wrapper_sfmsf_1",vt="_rewindControls_sfmsf_19",gt="_musicImage_sfmsf_29",kt="_button_sfmsf_37";var v={wrapper:yt,rewindControls:vt,musicImage:gt,button:kt};const bt="_box_dmcht_1";var xt={box:bt};const le=()=>t("div",{className:xt.box,children:t(M,{style:{fontSize:"1.7rem"},icon:he,color:"black"})}),Nt=({toggleAudio:e,nextTrack:o,prevTrack:n,playing:s})=>c("div",{className:v.wrapper,children:[t("div",{className:v.musicImage,children:t(le,{})}),t("button",{className:v.button,onClick:()=>e(),children:t(M,{size:"3x",icon:s?fe:ye,color:"black"})}),c("div",{className:v.rewindControls,children:[t("button",{className:v.button,onClick:()=>n(),children:t(M,{size:"2x",icon:ve,color:"black"})}),t("button",{className:v.button,onClick:()=>o(),children:t(M,{size:"2x",icon:ge,color:"black"})})]})]}),$t="_box_e863m_1",Tt="_title_e863m_17";var Y={box:$t,title:Tt};const wt=({volumeState:e,handleVolume:o})=>c("div",{className:Y.box,children:[c("p",{className:Y.title,children:["Volume: ",Math.round(e*100),"%"]}),t("input",{className:"clickable",type:"range",value:Math.round(e*100),onChange:n=>o(n)})]}),Z=e=>e<10?`0${e}`:`${e}`,ee=e=>{const o=Math.floor(e/60),n=Math.floor(e%60);return`${Z(o)}:${Z(n)}`},Ct="_infoInnerBox_1xn2v_1",Bt="_title_1xn2v_13",It="_progressBar_1xn2v_29",St="_info_1xn2v_1";var g={infoInnerBox:Ct,title:Bt,progressBar:It,info:St};const At=({track:e,duration:o,currentTime:n,handleProgress:s,canChangeTime:l})=>c("div",{className:g.info,children:[c("div",{className:g.infoInnerBox,children:[t("h2",{className:g.title,children:e==null?void 0:e.title}),t("p",{children:ee(o)})]}),c("div",{className:g.infoInnerBox,children:[t("h3",{className:g.title,children:e==null?void 0:e.author}),t("p",{children:ee(n)})]}),t("input",{className:g.progressBar,type:"range",disabled:!l,onChange:s,value:o?Math.round(n*100/o):0})]});let d=new Audio,A=!0;const Mt=200,Pt=()=>{const e=k(Q),o=k(f),n=k(F),s=k(L),l=k(G),{data:r}=oe(R),a=r==null?void 0:r.getAllTracks,u=i=>{if(!!d.src)switch(i.code){case"Space":i.preventDefault(),p();break}};m.exports.useEffect(()=>(window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[]);const P=()=>{if(!a||!o)return;const i=a.indexOf(o);f(i===0?a[a.length-1]:a[i-1])},T=()=>{if(!a||!o)return;const i=a.indexOf(o);i===a.length-1?f(a[0]):f(a[i+1])},E=()=>T();m.exports.useEffect(()=>{o&&(d.src=o.src,d.ontimeupdate=()=>F(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{A=!0},Mt),Q(d.duration)},d.onended=()=>{A=!1,E()},p())},[o]);const p=async()=>{if(d.paused){L(!0);try{await d.play()}catch(i){console.log(i)}}else L(!1),d.pause()},h=i=>{const D=+i.target.value;if(A){const b=D*e/100;d.currentTime=b,F(b)}},w=i=>{const b=+i.target.value/100;G(b),d.volume=b};return o?c("div",{className:X.player,children:[t(Nt,{toggleAudio:p,nextTrack:T,prevTrack:P,playing:s}),t("div",{className:X.musicImage,children:t(le,{})}),t(At,{track:o,duration:e,currentTime:n,handleProgress:h,canChangeTime:A}),t(wt,{volumeState:l,handleVolume:w})]}):null},Et=()=>c("div",{className:"container",children:[t(Pt,{}),t(pt,{})]});ke.render(t(be.StrictMode,{children:t(xe,{client:We,children:t(Et,{})})}),document.getElementById("root"));
