var se=Object.defineProperty,ie=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var U=(e,t,a)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,b=(e,t)=>{for(var a in t||(t={}))O.call(t,a)&&U(e,a,t[a]);if(I)for(var a of I(t))q.call(t,a)&&U(e,a,t[a]);return e},$=(e,t)=>ie(e,re(t));var x=(e,t)=>{var a={};for(var l in e)O.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(e!=null&&I)for(var l of I(e))t.indexOf(l)<0&&q.call(e,l)&&(a[l]=e[l]);return a};import{j as P,c as m,m as T,u as g,r as k,a as ce,f as de,b as ue,d as ne,e as me,I as pe,A as ke,R as _e,g as ve,h as fe}from"./vendor.e5795c61.js";const he=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}};he();const ye="_playlist_dy7d3_1",ge="_title_dy7d3_23",Ne="_head_dy7d3_33",be="_btn_dy7d3_45";var E={playlist:ye,title:ge,head:Ne,btn:be};const xe="_title_xynlk_1";var Te={title:xe};const n=P.exports.jsx,r=P.exports.jsxs,ae=P.exports.Fragment,we=a=>{var l=a,{className:e}=l,t=x(l,["className"]);return n("div",$(b({className:e},t),{children:n("p",{className:Te.title,children:"Connection Error"})}))},Se="_block_cfywl_1",Ie="_center_cfywl_9";var R={block:Se,center:Ie};const G=o=>{var s=o,{children:e,className:t,childsCenter:a}=s,l=x(s,["children","className","childsCenter"]);return n("div",$(b({className:m(R.block,t,{[R.center]:a})},l),{children:e}))},$e="_loading_clven_1",Be="_load_clven_1";var Ce={loading:$e,load:Be};const le=({className:e})=>n("div",{className:m(Ce.loading,e)}),Ae="_tracksBlock_diz2w_1";var Me={tracksBlock:Ae};const Ee="_track_i18so_1",Fe="_info_i18so_39",Ve="_text_i18so_53",De="_active_i18so_71",Pe="_trackBox_i18so_85";var h={track:Ee,info:Fe,text:Ve,active:De,trackBox:Pe};const Le=({title:e,active:t,subtitle:a,onClick:l})=>r("button",{onClick:()=>l(),className:m(h.track,{[h.active]:t}),children:[n("div",{className:h.trackBox}),r("div",{className:h.info,children:[n("span",{children:n("h2",{className:h.text,children:e})}),n("div",{children:n("h3",{className:h.text,children:a})})]})]}),f=T(null),F=T(!1),K=T(.5),V=T(0),Q=T(0),je=({data:e})=>{const t=g(f),a=l=>()=>f(l);return n("ul",{className:Me.tracksBlock,children:e.map(l=>n("li",{children:n(Le,{active:l.id===(t==null?void 0:t.id),onClick:a(l),title:l.title,subtitle:l.author})},l.id))})},Ue="_button_ptj0d_1";var Oe={button:Ue};const oe=l=>{var o=l,{children:e,className:t}=o,a=x(o,["children","className"]);return n("button",$(b({className:m(Oe.button,t)},a),{children:e}))},qe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addTrack"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"author"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"file"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addTrack"},arguments:[{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"author"},value:{kind:"Variable",name:{kind:"Name",value:"author"}}},{kind:"Argument",name:{kind:"Name",value:"file"},value:{kind:"Variable",name:{kind:"Name",value:"file"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"src"}},{kind:"Field",name:{kind:"Name",value:"author"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},L={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetAllTracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getAllTracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"author"}},{kind:"Field",name:{kind:"Name",value:"src"}}]}}]}}]},Re="__lock_1up8e_1",Ge="_modal_1up8e_9",Ke="_overlay_1up8e_41";var B={_lock:Re,modal:Ge,overlay:Ke};const z=document.getElementById("modal"),Qe=({className:e,children:t,open:a,onClose:l})=>{const o=s=>{console.log("click"),(s.key==="Esc"||s.key==="Escape")&&l()};return k.exports.useEffect(()=>{document.body.classList.add(B._lock)},[]),k.exports.useEffect(()=>{if(document.body.classList.toggle(B._lock),a)return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[a]),!a||!z?n(ae,{}):ce.exports.createPortal(n(de,{children:n("div",{onClick:()=>l(),className:B.overlay,children:n("div",{onClick:s=>s.stopPropagation(),role:"dialog",className:m(B.modal,e),children:t})})}),z)},ze="_form_1mtor_1",He="_btn_1mtor_15",Je="_uploadTitle_1mtor_27";var D={form:ze,btn:He,uploadTitle:Je};const We="_input_uv6sf_1";var Xe={input:We};const H=s=>{var i=s,{inputState:e,setInputState:t,labelText:a,className:l}=i,o=x(i,["inputState","setInputState","labelText","className"]);return r("label",{children:[n("h3",{children:a}),n("input",b({required:!0,className:m(Xe.input,l),value:e,onChange:u=>t(u.target.value),type:"text"},o))]})},Ye="_block_r92fe_1",Ze="_title_r92fe_17";var J={block:Ye,title:Ze};const et=({title:e="Uploading track. Please wait.",className:t})=>r("div",{className:m(J.block,t),children:[n("p",{className:J.title,children:e}),n(le,{})]}),tt=({onSubmit:e})=>{const[t,a]=k.exports.useState(null),[l,o]=k.exports.useState(""),[s,i]=k.exports.useState(""),[u,{loading:A}]=ue(qe),w=_=>{var S;const v=(S=_.target.files)==null?void 0:S[0];v&&v.type.includes("audio/")?a(v):alert("Select audio/mpeg file")},M=async _=>{_.preventDefault();try{await u({variables:{title:l,author:s,file:t},refetchQueries:[{query:L}]}),e(),i(""),o("")}catch(v){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",v)}};return A?n(et,{}):r("form",{className:D.form,action:"",onSubmit:M,children:[n("h1",{children:"Upload Track"}),n(H,{inputState:s,setInputState:i,labelText:"Author"}),n(H,{inputState:l,setInputState:o,labelText:"Title"}),r("label",{children:[n("h1",{className:D.uploadTitle,children:"Upload audio File"}),n("input",{required:!0,type:"file",accept:"audio/*",onChange:w})]}),n(oe,{className:D.btn,type:"submit",children:"Upload Track"})]})},nt="_uploadModal_16r2l_1";var at={uploadModal:nt};const lt=({isOpen:e,onClose:t})=>n(Qe,{className:at.uploadModal,open:e,onClose:t,children:n(tt,{onSubmit:t})}),ot=({})=>{const{data:e,loading:t,error:a}=ne(L),[l,o]=k.exports.useState(!1),s=()=>o(!1),i=()=>o(!0),u=e==null?void 0:e.getAllTracks;return a?n(G,{children:n(we,{})}):t||!u?n(G,{childsCenter:!0,children:n(le,{})}):r("section",{className:E.playlist,children:[r("div",{className:E.head,children:[n("h1",{className:E.title,children:`Playlist: ${u.length}`}),n(oe,{onClick:i,children:"Add new track"})]}),n(je,{data:u}),n(lt,{isOpen:l,onClose:s})]})},st="_player_1x5nx_1",it="_musicImage_1x5nx_55";var W={player:st,musicImage:it};const rt="_rewindControls_17y3e_1",ct="_button_17y3e_13",dt="_toggleButton_17y3e_41",ut="_arrow_17y3e_59",mt="_inverse_17y3e_67";var p={rewindControls:rt,button:ct,toggleButton:dt,arrow:ut,inverse:mt},pt="/music-playlist-fullstack/assets/playIcon.916a18da.svg",X="/music-playlist-fullstack/assets/arrowIcon.f4b42ba4.svg",kt="/music-playlist-fullstack/assets/pauseIcon.8b6d1de2.svg";const _t=({toggleAudio:e,nextTrack:t,prevTrack:a,playing:l})=>r(ae,{children:[n("button",{className:m(p.button,p.toggleButton),onClick:()=>e(),children:n("img",{src:l?kt:pt,alt:"play"})}),r("div",{className:p.rewindControls,children:[n("button",{className:p.button,onClick:()=>a(),children:n("img",{className:m(p.arrow,p.inverse),src:X,alt:"back"})}),n("button",{className:p.button,onClick:()=>t(),children:n("img",{className:p.arrow,src:X,alt:"forward"})})]})]}),vt="_box_1x3q1_1",ft="_title_1x3q1_19";var Y={box:vt,title:ft};const ht=({volumeState:e,handleVolume:t})=>r("div",{className:Y.box,children:[r("p",{className:Y.title,children:["Volume: ",Math.round(e*100),"%"]}),n("input",{className:"clickable",type:"range",value:Math.round(e*100),onChange:a=>t(a)})]}),yt="_box_r74l1_1",gt="_image_r74l1_21";var Z={box:yt,image:gt},Nt="/music-playlist-fullstack/assets/musicIcon.4498a0e2.svg";const bt=({})=>n("div",{className:Z.box,children:n("img",{className:Z.image,src:Nt,alt:"music"})}),ee=e=>e<10?`0${e}`:`${e}`,te=e=>{const t=Math.floor(e/60),a=Math.floor(e%60);return`${ee(t)}:${ee(a)}`},xt="_infoInnerBox_jt7d9_1",Tt="_title_jt7d9_13",wt="_progressBar_jt7d9_29",St="_info_jt7d9_1";var y={infoInnerBox:xt,title:Tt,progressBar:wt,info:St};const It=({track:e,duration:t,currentTime:a,handleProgress:l,canChangeTime:o})=>r("div",{className:y.info,children:[r("div",{className:y.infoInnerBox,children:[n("h2",{className:y.title,children:e==null?void 0:e.title}),n("p",{children:te(t)})]}),r("div",{className:y.infoInnerBox,children:[n("h3",{className:y.title,children:e==null?void 0:e.author}),n("p",{children:te(a)})]}),n("input",{className:y.progressBar,type:"range",disabled:!o,onChange:l,value:t?Math.round(a*100/t):0})]});let d=new Audio,C=!0;const $t=200,Bt=({})=>{const e=g(Q),t=g(f),a=g(V),l=g(F),o=g(K),{data:s}=ne(L),i=s==null?void 0:s.getAllTracks,u=c=>{if(!!d.src)switch(c.code){case"Space":c.preventDefault(),_();break}};k.exports.useEffect(()=>(d.volume=o,window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[]);const A=()=>{if(!i||!t)return;const c=i.indexOf(t);f(c===0?i[i.length-1]:i[c-1])},w=()=>{if(!i||!t)return;const c=i.indexOf(t);c===i.length-1?f(i[0]):f(i[c+1])},M=()=>w();k.exports.useEffect(()=>{t&&(d.src=t.src,d.ontimeupdate=()=>V(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{C=!0},$t),Q(d.duration)},d.onended=()=>{C=!1,M()},_())},[t]);const _=async()=>{if(d.paused){F(!0);try{await d.play()}catch(c){console.log(c)}}else F(!1),d.pause()},v=c=>{const j=+c.target.value;if(C){const N=j*e/100;d.currentTime=N,V(N)}},S=c=>{const N=+c.target.value/100;K(N),d.volume=N};return t?r("div",{className:W.player,children:[n(_t,{toggleAudio:_,nextTrack:w,prevTrack:A,playing:l}),n("div",{className:W.musicImage,children:n(bt,{})}),n(It,{track:t,duration:e,currentTime:a,handleProgress:v,canChangeTime:C}),n(ht,{volumeState:o,handleVolume:S})]}):null},Ct=()=>r("div",{className:"container",children:[n(Bt,{}),n(ot,{})]}),At="https://eyes-closed-server.herokuapp.com/graphql",Mt=me({uri:At}),Et=new pe,Ft=new ke({link:Mt,cache:Et});_e.render(n(ve.StrictMode,{children:n(fe,{client:Ft,children:n(Ct,{})})}),document.getElementById("root"));
