var le=Object.defineProperty,ae=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var j=(o,t,n)=>t in o?le(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,w=(o,t)=>{for(var n in t||(t={}))O.call(t,n)&&j(o,n,t[n]);if($)for(var n of $(t))z.call(t,n)&&j(o,n,t[n]);return o},L=(o,t)=>ae(o,re(t));var B=(o,t)=>{var n={};for(var s in o)O.call(o,s)&&t.indexOf(s)<0&&(n[s]=o[s]);if(o!=null&&$)for(var s of $(o))t.indexOf(s)<0&&z.call(o,s)&&(n[s]=o[s]);return n};import{j as U,c as b,g as ee,a as ce,I as ie,A as de,m as k,u as v,r as m,b as ue,d as me,e as te,F as M,f as _e,h as pe,i as he,k as fe,l as ge,R as ye,n as ve,o as xe}from"./vendor.402c6bd1.js";const be=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=n(l);fetch(l.href,a)}};be();const ke="_playlist_11scu_1",Ne="_title_11scu_23",Te="_head_11scu_33",$e="_uploadModal_11scu_45",we="_btn_11scu_57";var C={playlist:ke,title:Ne,head:Te,uploadModal:$e,btn:we};const Be="_title_xynlk_1";var Ce={title:Be};const e=U.exports.jsx,c=U.exports.jsxs,V=U.exports.Fragment,Ie=()=>e("div",{children:e("p",{className:Ce.title,children:"Connection Error"})}),Se="_block_11qbe_1";var Ae={block:Se};const K=s=>{var l=s,{children:o,className:t}=l,n=B(l,["children","className"]);return e("div",L(w({className:b(Ae.block,t)},n),{children:o}))},Me="_loadingWrapper_flrcn_1",Pe="_loading_flrcn_1",Ee="_load_flrcn_1";var W={loadingWrapper:Me,loading:Pe,load:Ee};const oe=()=>e("div",{className:W.loadingWrapper,children:e("div",{className:W.loading})}),D=ee`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,Le="_tracksBlock_diz2w_1";var Fe={tracksBlock:Le};const qe="_track_dy45d_1",Ve="_info_dy45d_41",Ue="_innerBox_dy45d_61",De="_text_dy45d_69",Re="_active_dy45d_89",je="_trackBox_dy45d_107";var _={track:qe,info:Ve,innerBox:Ue,text:De,active:Re,trackBox:je};const Oe=({title:o,active:t,subtitle:n,onClick:s})=>c("button",{onClick:()=>s(),className:b(_.track,{[_.active]:t}),children:[e("div",{className:_.trackBox}),c("div",{className:_.info,children:[e("div",{className:_.innerBox,children:e("h2",{className:_.text,children:o})}),e("div",{className:_.innerBox,children:e("h3",{className:_.text,children:n})})]})]}),f=k(null),F=k(!1),G=k(1),q=k(0),Q=k(0),ze="https://eyes-closed-server.herokuapp.com/graphql",Ke=ce({uri:ze}),We=new ie,Ge=new de({link:Ke,cache:We}),Qe=({data:o})=>{const t=v(f),n=s=>()=>f(s);return e("ul",{className:Fe.tracksBlock,children:o.map(s=>e("li",{children:e(Oe,{active:s.id===(t==null?void 0:t.id),onClick:n(s),title:s.title,subtitle:s.author})},s.id))})},He="_button_ptj0d_1";var Je={button:He};const ne=s=>{var l=s,{children:o,className:t}=l,n=B(l,["children","className"]);return e("button",L(w({className:b(Je.button,t)},n),{children:o}))},Xe="__lock_rqvxe_1",Ye="_modal_rqvxe_9",Ze="_overlay_rqvxe_39";var I={_lock:Xe,modal:Ye,overlay:Ze};const H=document.getElementById("modal"),et=({className:o,children:t,open:n,onClose:s})=>(m.exports.useEffect(()=>{document.body.classList.add(I._lock)},[]),m.exports.useEffect(()=>{document.body.classList.toggle(I._lock)},[n]),!n||!H?e(V,{}):ue.exports.createPortal(c(V,{children:[e("div",{onClick:s,className:I.overlay}),e("div",{className:b(I.modal,o),children:t})]}),H)),tt="_form_1598g_1",ot="_btn_1598g_15",nt="_uploadTitle_1598g_27",st="_loadingTitle_1598g_39";var S={form:tt,btn:ot,uploadTitle:nt,loadingTitle:st};const lt=ee`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,at="_input_uv6sf_1";var rt={input:at};const J=m.exports.memo(a=>{var r=a,{inputState:o,setInputState:t,labelText:n,className:s}=r,l=B(r,["inputState","setInputState","labelText","className"]);return c("label",{children:[e("h3",{children:n}),e("input",w({required:!0,className:b(rt.input,s),value:o,onChange:u=>t(u.target.value),type:"text"},l))]})}),ct=({onSubmit:o})=>{const[t,n]=m.exports.useState(null),[s,l]=m.exports.useState(""),[a,r]=m.exports.useState(""),[u,{loading:P}]=me(lt),N=p=>{var T;const h=(T=p.target.files)==null?void 0:T[0];h&&h.type.includes("audio/")?n(h):alert("Select audio/mpeg file")},E=async p=>{p.preventDefault();try{await u({variables:{title:s,author:a,file:t},refetchQueries:[{query:D}]}),o(),r(""),l("")}catch(h){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",h)}};return P?c(V,{children:[e("p",{className:S.loadingTitle,children:"Uploading track. Please wait."}),e(oe,{})]}):c("form",{className:S.form,action:"",onSubmit:E,children:[e("h1",{children:"Upload Track"}),e(J,{inputState:a,setInputState:r,labelText:"Author"}),e(J,{inputState:s,setInputState:l,labelText:"Title"}),c("label",{children:[e("h1",{className:S.uploadTitle,children:"Upload audio File"}),e("input",{required:!0,type:"file",accept:"audio/*",onChange:N})]}),e(ne,{className:S.btn,type:"submit",children:"Upload Track"})]})},it=()=>{const{data:o,loading:t,error:n}=te(D),[s,l]=m.exports.useState(!1),a=o==null?void 0:o.getAllTracks;if(n)return e(K,{children:e(Ie,{})});if(t||!a)return e(K,{children:e(oe,{})});const r=()=>()=>l(!0),u=()=>()=>l(!1);return c("section",{className:C.playlist,children:[c("div",{className:C.head,children:[e("h1",{className:C.title,children:`Playlist: ${a.length}`}),e(ne,{onClick:r(),children:"Add new track"})]}),e(Qe,{data:a}),e(et,{className:C.uploadModal,open:s,onClose:u(),children:e(ct,{onSubmit:u()})})]})},dt="_player_1glm3_1",ut="_musicImage_1glm3_57";var X={player:dt,musicImage:ut};const mt="_wrapper_sfmsf_1",_t="_rewindControls_sfmsf_19",pt="_musicImage_sfmsf_29",ht="_button_sfmsf_37";var g={wrapper:mt,rewindControls:_t,musicImage:pt,button:ht};const ft="_box_dmcht_1";var gt={box:ft};const se=()=>e("div",{className:gt.box,children:e(M,{style:{fontSize:"1.7rem"},icon:_e,color:"black"})}),yt=({toggleAudio:o,nextTrack:t,prevTrack:n,playing:s})=>c("div",{className:g.wrapper,children:[e("div",{className:g.musicImage,children:e(se,{})}),e("button",{className:g.button,onClick:()=>o(),children:e(M,{size:"3x",icon:s?pe:he,color:"black"})}),c("div",{className:g.rewindControls,children:[e("button",{className:g.button,onClick:()=>n(),children:e(M,{size:"2x",icon:fe,color:"black"})}),e("button",{className:g.button,onClick:()=>t(),children:e(M,{size:"2x",icon:ge,color:"black"})})]})]}),vt="_box_e863m_1",xt="_title_e863m_17";var Y={box:vt,title:xt};const bt=({volumeState:o,handleVolume:t})=>c("div",{className:Y.box,children:[c("p",{className:Y.title,children:["Volume: ",Math.round(o*100),"%"]}),e("input",{className:"clickable",type:"range",value:Math.round(o*100),onChange:n=>t(n)})]}),Z=o=>{const t=Math.floor(o/60),n=Math.floor(o%60),s=t<10?`0${t}`:`${t}`,l=n<10?`0${n}`:`${n}`;return`${s}:${l}`},kt="_infoInnerBox_1xn2v_1",Nt="_title_1xn2v_13",Tt="_progressBar_1xn2v_29",$t="_info_1xn2v_1";var y={infoInnerBox:kt,title:Nt,progressBar:Tt,info:$t};const wt=({track:o,duration:t,currentTime:n,handleProgress:s,canChangeTime:l})=>c("div",{className:y.info,children:[c("div",{className:y.infoInnerBox,children:[e("h2",{className:y.title,children:o==null?void 0:o.title}),e("p",{children:Z(t)})]}),c("div",{className:y.infoInnerBox,children:[e("h3",{className:y.title,children:o==null?void 0:o.author}),e("p",{children:Z(n)})]}),e("input",{className:y.progressBar,type:"range",disabled:!l,onChange:s,value:t?Math.round(n*100/t):0})]});let d=new Audio,A=!0;const Bt=200,Ct=()=>{const o=v(Q),t=v(f),n=v(q),s=v(F),l=v(G),{data:a}=te(D),r=a==null?void 0:a.getAllTracks,u=i=>{if(!!d.src)switch(i.code){case"Space":i.preventDefault(),p();break}};m.exports.useEffect(()=>(window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[]);const P=()=>{if(!r||!t)return;const i=r.indexOf(t);f(i===0?r[r.length-1]:r[i-1])},N=()=>{if(!r||!t)return;const i=r.indexOf(t);i===r.length-1?f(r[0]):f(r[i+1])},E=()=>N();m.exports.useEffect(()=>{t&&(d.src=t.src,d.ontimeupdate=()=>q(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{A=!0},Bt),Q(d.duration)},d.onended=()=>{A=!1,E()},p())},[t]);const p=async()=>{if(d.paused){F(!0);try{await d.play()}catch(i){console.log(i)}}else F(!1),d.pause()},h=i=>{const R=+i.target.value;if(A){const x=R*o/100;d.currentTime=x,q(x)}},T=i=>{const x=+i.target.value/100;G(x),d.volume=x};return t?c("div",{className:X.player,children:[e(yt,{toggleAudio:p,nextTrack:N,prevTrack:P,playing:s}),e("div",{className:X.musicImage,children:e(se,{})}),e(wt,{track:t,duration:o,currentTime:n,handleProgress:h,canChangeTime:A}),e(bt,{volumeState:l,handleVolume:T})]}):null},It=()=>c("div",{className:"container",children:[e(Ct,{}),e(it,{})]});ye.render(e(ve.StrictMode,{children:e(xe,{client:Ge,children:e(It,{})})}),document.getElementById("root"));
