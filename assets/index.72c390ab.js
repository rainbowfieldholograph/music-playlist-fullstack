var oe=Object.defineProperty,se=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var O=(e,t,a)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,b=(e,t)=>{for(var a in t||(t={}))j.call(t,a)&&O(e,a,t[a]);if(w)for(var a of w(t))R.call(t,a)&&O(e,a,t[a]);return e},I=(e,t)=>se(e,ie(t));var x=(e,t)=>{var a={};for(var l in e)j.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(e!=null&&w)for(var l of w(e))t.indexOf(l)<0&&R.call(e,l)&&(a[l]=e[l]);return a};import{j as L,c as f,a as re,I as ce,A as de,m as T,u as g,r as m,b as ue,f as me,d as pe,e as te,F,g as ke,h as _e,i as fe,k as he,l as ve,R as ye,n as ge,o as Ne}from"./vendor.de18b323.js";const be=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}};be();const xe="_playlist_dy7d3_1",Te="_title_dy7d3_23",Se="_head_dy7d3_33",$e="_btn_dy7d3_45";var V={playlist:xe,title:Te,head:Se,btn:$e};const we="_title_xynlk_1";var Ie={title:we};const n=L.exports.jsx,r=L.exports.jsxs,Ce=L.exports.Fragment,Be=a=>{var l=a,{className:e}=l,t=x(l,["className"]);return n("div",I(b({className:e},t),{children:n("p",{className:Ie.title,children:"Connection Error"})}))},Fe="_block_cfywl_1",Ae="_center_cfywl_9";var q={block:Fe,center:Ae};const G=o=>{var s=o,{children:e,className:t,childsCenter:a}=s,l=x(s,["children","className","childsCenter"]);return n("div",I(b({className:f(q.block,t,{[q.center]:a})},l),{children:e}))},Me="_loading_clven_1",Ve="_load_clven_1";var Pe={loading:Me,load:Ve};const ne=({className:e})=>n("div",{className:f(Pe.loading,e)}),De="_tracksBlock_diz2w_1";var Ee={tracksBlock:De};const Le="_track_1tzts_1",Ue="_info_1tzts_39",ze="_text_1tzts_53",Oe="_active_1tzts_71",je="_trackBox_1tzts_85";var h={track:Le,info:Ue,text:ze,active:Oe,trackBox:je};const Re=({title:e,active:t,subtitle:a,onClick:l})=>r("button",{onClick:()=>l(),className:f(h.track,{[h.active]:t}),children:[n("div",{className:h.trackBox}),r("div",{className:h.info,children:[n("span",{children:n("h2",{className:h.text,children:e})}),n("div",{children:n("h3",{className:h.text,children:a})})]})]}),_=T(null),P=T(!1),K=T(.5),D=T(0),Q=T(0),qe="https://eyes-closed-server.herokuapp.com/graphql",Ge=re({uri:qe}),Ke=new ce,Qe=new de({link:Ge,cache:Ke}),He=({data:e})=>{const t=g(_),a=l=>()=>_(l);return n("ul",{className:Ee.tracksBlock,children:e.map(l=>n("li",{children:n(Re,{active:l.id===(t==null?void 0:t.id),onClick:a(l),title:l.title,subtitle:l.author})},l.id))})},Je="_button_ptj0d_1";var We={button:Je};const ae=l=>{var o=l,{children:e,className:t}=o,a=x(o,["children","className"]);return n("button",I(b({className:f(We.button,t)},a),{children:e}))},Xe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addTrack"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"author"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"file"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addTrack"},arguments:[{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"author"},value:{kind:"Variable",name:{kind:"Name",value:"author"}}},{kind:"Argument",name:{kind:"Name",value:"file"},value:{kind:"Variable",name:{kind:"Name",value:"file"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"src"}},{kind:"Field",name:{kind:"Name",value:"author"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},U={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetAllTracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getAllTracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"author"}},{kind:"Field",name:{kind:"Name",value:"src"}}]}}]}}]},Ye="__lock_1up8e_1",Ze="_modal_1up8e_9",et="_overlay_1up8e_41";var C={_lock:Ye,modal:Ze,overlay:et};const H=document.getElementById("modal"),tt=({className:e,children:t,open:a,onClose:l})=>(m.exports.useEffect(()=>{document.body.classList.add(C._lock)},[]),m.exports.useEffect(()=>{document.body.classList.toggle(C._lock)},[a]),!a||!H?n(Ce,{}):ue.exports.createPortal(n(me,{children:n("div",{onClick:()=>l(),className:C.overlay,children:n("div",{onClick:o=>o.stopPropagation(),role:"dialog",className:f(C.modal,e),children:t})})}),H)),nt="_form_1mtor_1",at="_btn_1mtor_15",lt="_uploadTitle_1mtor_27";var E={form:nt,btn:at,uploadTitle:lt};const ot="_input_uv6sf_1";var st={input:ot};const J=s=>{var i=s,{inputState:e,setInputState:t,labelText:a,className:l}=i,o=x(i,["inputState","setInputState","labelText","className"]);return r("label",{children:[n("h3",{children:a}),n("input",b({required:!0,className:f(st.input,l),value:e,onChange:u=>t(u.target.value),type:"text"},o))]})},it="_block_r92fe_1",rt="_title_r92fe_17";var W={block:it,title:rt};const ct=({title:e="Uploading track. Please wait.",className:t})=>r("div",{className:f(W.block,t),children:[n("p",{className:W.title,children:e}),n(ne,{})]}),dt=({onSubmit:e})=>{const[t,a]=m.exports.useState(null),[l,o]=m.exports.useState(""),[s,i]=m.exports.useState(""),[u,{loading:A}]=pe(Xe),S=p=>{var $;const k=($=p.target.files)==null?void 0:$[0];k&&k.type.includes("audio/")?a(k):alert("Select audio/mpeg file")},M=async p=>{p.preventDefault();try{await u({variables:{title:l,author:s,file:t},refetchQueries:[{query:U}]}),e(),i(""),o("")}catch(k){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",k)}};return A?n(ct,{}):r("form",{className:E.form,action:"",onSubmit:M,children:[n("h1",{children:"Upload Track"}),n(J,{inputState:s,setInputState:i,labelText:"Author"}),n(J,{inputState:l,setInputState:o,labelText:"Title"}),r("label",{children:[n("h1",{className:E.uploadTitle,children:"Upload audio File"}),n("input",{required:!0,type:"file",accept:"audio/*",onChange:S})]}),n(ae,{className:E.btn,type:"submit",children:"Upload Track"})]})},ut="_uploadModal_16r2l_1";var mt={uploadModal:ut};const pt=({isOpen:e,onClose:t})=>n(tt,{className:mt.uploadModal,open:e,onClose:t,children:n(dt,{onSubmit:t})}),kt=({})=>{const{data:e,loading:t,error:a}=te(U),[l,o]=m.exports.useState(!1),s=()=>o(!1),i=()=>o(!0),u=e==null?void 0:e.getAllTracks;return a?n(G,{children:n(Be,{})}):t||!u?n(G,{childsCenter:!0,children:n(ne,{})}):r("section",{className:V.playlist,children:[r("div",{className:V.head,children:[n("h1",{className:V.title,children:`Playlist: ${u.length}`}),n(ae,{onClick:i,children:"Add new track"})]}),n(He,{data:u}),n(pt,{isOpen:l,onClose:s})]})},_t="_player_1s3k7_1",ft="_musicImage_1s3k7_59";var X={player:_t,musicImage:ft};const ht="_wrapper_sfmsf_1",vt="_rewindControls_sfmsf_19",yt="_musicImage_sfmsf_29",gt="_button_sfmsf_37";var v={wrapper:ht,rewindControls:vt,musicImage:yt,button:gt};const Nt="_box_dmcht_1";var bt={box:Nt};const le=({})=>n("div",{className:bt.box,children:n(F,{style:{fontSize:"1.7rem"},icon:ke,color:"black"})}),xt=({toggleAudio:e,nextTrack:t,prevTrack:a,playing:l})=>r("div",{className:v.wrapper,children:[n("div",{className:v.musicImage,children:n(le,{})}),n("button",{className:v.button,onClick:()=>e(),children:n(F,{size:"3x",icon:l?_e:fe,color:"black"})}),r("div",{className:v.rewindControls,children:[n("button",{className:v.button,onClick:()=>a(),children:n(F,{size:"2x",icon:he,color:"black"})}),n("button",{className:v.button,onClick:()=>t(),children:n(F,{size:"2x",icon:ve,color:"black"})})]})]}),Tt="_box_e863m_1",St="_title_e863m_17";var Y={box:Tt,title:St};const $t=({volumeState:e,handleVolume:t})=>r("div",{className:Y.box,children:[r("p",{className:Y.title,children:["Volume: ",Math.round(e*100),"%"]}),n("input",{className:"clickable",type:"range",value:Math.round(e*100),onChange:a=>t(a)})]}),Z=e=>e<10?`0${e}`:`${e}`,ee=e=>{const t=Math.floor(e/60),a=Math.floor(e%60);return`${Z(t)}:${Z(a)}`},wt="_infoInnerBox_1xn2v_1",It="_title_1xn2v_13",Ct="_progressBar_1xn2v_29",Bt="_info_1xn2v_1";var y={infoInnerBox:wt,title:It,progressBar:Ct,info:Bt};const Ft=({track:e,duration:t,currentTime:a,handleProgress:l,canChangeTime:o})=>r("div",{className:y.info,children:[r("div",{className:y.infoInnerBox,children:[n("h2",{className:y.title,children:e==null?void 0:e.title}),n("p",{children:ee(t)})]}),r("div",{className:y.infoInnerBox,children:[n("h3",{className:y.title,children:e==null?void 0:e.author}),n("p",{children:ee(a)})]}),n("input",{className:y.progressBar,type:"range",disabled:!o,onChange:l,value:t?Math.round(a*100/t):0})]});let d=new Audio,B=!0;const At=200,Mt=({})=>{const e=g(Q),t=g(_),a=g(D),l=g(P),o=g(K),{data:s}=te(U),i=s==null?void 0:s.getAllTracks,u=c=>{if(!!d.src)switch(c.code){case"Space":c.preventDefault(),p();break}};m.exports.useEffect(()=>(window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[]);const A=()=>{if(!i||!t)return;const c=i.indexOf(t);_(c===0?i[i.length-1]:i[c-1])},S=()=>{if(!i||!t)return;const c=i.indexOf(t);c===i.length-1?_(i[0]):_(i[c+1])},M=()=>S();m.exports.useEffect(()=>{t&&(d.src=t.src,d.ontimeupdate=()=>D(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{B=!0},At),Q(d.duration)},d.onended=()=>{B=!1,M()},p())},[t]);const p=async()=>{if(d.paused){P(!0);try{await d.play()}catch(c){console.log(c)}}else P(!1),d.pause()},k=c=>{const z=+c.target.value;if(B){const N=z*e/100;d.currentTime=N,D(N)}},$=c=>{const N=+c.target.value/100;K(N),d.volume=N};return t?r("div",{className:X.player,children:[n(xt,{toggleAudio:p,nextTrack:S,prevTrack:A,playing:l}),n("div",{className:X.musicImage,children:n(le,{})}),n(Ft,{track:t,duration:e,currentTime:a,handleProgress:k,canChangeTime:B}),n($t,{volumeState:o,handleVolume:$})]}):null},Vt=()=>r("div",{className:"container",children:[n(Mt,{}),n(kt,{})]});ye.render(n(ge.StrictMode,{children:n(Ne,{client:Qe,children:n(Vt,{})})}),document.getElementById("root"));
