var oe=Object.defineProperty,re=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var C=(t,e,a)=>e in t?oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,p=(t,e)=>{for(var a in e||(e={}))B.call(e,a)&&C(t,a,e[a]);if(w)for(var a of w(e))P.call(e,a)&&C(t,a,e[a]);return t},x=(t,e)=>re(t,le(e));var g=(t,e)=>{var a={};for(var r in t)B.call(t,r)&&e.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&w)for(var r of w(t))e.indexOf(r)<0&&P.call(t,r)&&(a[r]=t[r]);return a};var d=(t,e,a)=>(C(t,typeof e!="symbol"?e+"":e,a),a);import{j as I,c as m,m as v,u as k,r as i,a as ie,f as se,b as ce,d as M,e as de,I as ue,A as me,R as pe,g as ke,h as he}from"./vendor.e5795c61.js";const _e=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=a(o);fetch(o.href,l)}};_e();const ge="_playlist_dy7d3_1",ve="_title_dy7d3_23",ye="_head_dy7d3_33",fe="_btn_dy7d3_45";var $={playlist:ge,title:ve,head:ye,btn:fe};const xe="_title_xynlk_1";var be={title:xe};const n=I.exports.jsx,s=I.exports.jsxs,W=I.exports.Fragment,Ne=a=>{var r=a,{className:t}=r,e=g(r,["className"]);return n("div",x(p({className:t},e),{children:n("p",{className:be.title,children:"Connection Error"})}))},we="_block_cfywl_1",Te="_center_cfywl_9";var F={block:we,center:Te};const L=o=>{var l=o,{children:t,className:e,childsCenter:a}=l,r=g(l,["children","className","childsCenter"]);return n("div",x(p({className:m(F.block,e,{[F.center]:a})},r),{children:t}))},Ve="_loading_clven_1",Se="_load_clven_1";var Ce={loading:Ve,load:Se};const Y=({className:t})=>n("div",{className:m(Ce.loading,t)}),$e="_tracksBlock_diz2w_1";var Ee={tracksBlock:$e};const Ie="_track_i18so_1",Me="_info_i18so_39",Ae="_text_i18so_53",Be="_active_i18so_71",Pe="_trackBox_i18so_85";var y={track:Ie,info:Me,text:Ae,active:Be,trackBox:Pe};const Fe=({title:t,active:e,subtitle:a,onClick:r})=>s("button",{onClick:()=>r(),className:m(y.track,{[y.active]:e}),children:[n("div",{className:y.trackBox}),s("div",{className:y.info,children:[n("h2",{className:y.text,children:t}),n("h3",{className:y.text,children:a})]})]});class Le{constructor(){d(this,"audio",new Audio);d(this,"currentTrackVar",v(null));d(this,"isPlayingVar",v(!1));d(this,"canChangeTimeVar",v(!0));d(this,"volumeVar",v(.5));d(this,"currentTimeVar",v(0));d(this,"durationVar",v(0));d(this,"switchTrack",(e,a)=>{const r=this.currentTrackVar();if(!e||!r)return;const o=e.findIndex(l=>l.id===r.id);switch(a){case"NEXT":o===e.length-1?this.currentTrackVar(e[0]):this.currentTrackVar(e[o+1]);break;case"PREV":o===0?this.currentTrackVar(e[e.length-1]):this.currentTrackVar(e[o-1]);break}});d(this,"prevTrack",e=>this.switchTrack(e,"PREV"));d(this,"nextTrack",e=>this.switchTrack(e,"NEXT"));d(this,"toggleAudio",async()=>{if(this.audio.paused){this.isPlayingVar(!0);try{await this.audio.play()}catch(e){console.log(e)}}else this.isPlayingVar(!1),this.audio.pause()})}}var N=new Le;const De=({data:t})=>{const{currentTrackVar:e}=N,a=k(e),r=o=>()=>e(o);return n("ul",{className:Ee.tracksBlock,children:t.map(o=>n("li",{children:n(Fe,{active:o.id===(a==null?void 0:a.id),onClick:r(o),title:o.title,subtitle:o.author})},o.id))})},je="_button_ptj0d_1";var Re={button:je};const Z=r=>{var o=r,{children:t,className:e}=o,a=g(o,["children","className"]);return n("button",x(p({className:m(Re.button,e)},a),{children:t}))},Ue={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addTrack"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"author"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"file"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addTrack"},arguments:[{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"author"},value:{kind:"Variable",name:{kind:"Name",value:"author"}}},{kind:"Argument",name:{kind:"Name",value:"file"},value:{kind:"Variable",name:{kind:"Name",value:"file"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"src"}},{kind:"Field",name:{kind:"Name",value:"author"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},V={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetAllTracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getAllTracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"author"}},{kind:"Field",name:{kind:"Name",value:"src"}}]}}]}}]},qe="__lock_1up8e_1",Oe="_modal_1up8e_9",ze="_overlay_1up8e_41";var T={_lock:qe,modal:Oe,overlay:ze};const D=document.getElementById("modal"),Xe=({className:t,children:e,open:a,onClose:r})=>{const o=l=>{(l.key==="Esc"||l.key==="Escape")&&r()};return i.exports.useEffect(()=>{document.body.classList.add(T._lock)},[]),i.exports.useEffect(()=>{if(document.body.classList.toggle(T._lock),a)return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[a]),!a||!D?n(W,{}):ie.exports.createPortal(n(se,{children:n("div",{onClick:()=>r(),className:T.overlay,children:n("div",{onClick:l=>l.stopPropagation(),role:"dialog",className:m(T.modal,t),children:e})})}),D)},Ge="_form_1mtor_1",Ke="_btn_1mtor_15",Qe="_uploadTitle_1mtor_27";var E={form:Ge,btn:Ke,uploadTitle:Qe};const He="_input_uv6sf_1";var Je={input:He};const j=l=>{var c=l,{inputState:t,setInputState:e,labelText:a,className:r}=c,o=g(c,["inputState","setInputState","labelText","className"]);return s("label",{children:[n("h3",{children:a}),n("input",p({required:!0,className:m(Je.input,r),value:t,onChange:h=>e(h.target.value),type:"text"},o))]})},We="_block_r92fe_1",Ye="_title_r92fe_17";var R={block:We,title:Ye};const Ze=({title:t="Uploading track. Please wait.",className:e})=>s("div",{className:m(R.block,e),children:[n("p",{className:R.title,children:t}),n(Y,{})]}),et=({onSubmit:t})=>{const[e,a]=i.exports.useState(null),[r,o]=i.exports.useState(""),[l,c]=i.exports.useState(""),[h,{loading:te}]=ce(Ue),ne=S=>{var A;const f=(A=S.target.files)==null?void 0:A[0];f&&f.type.includes("audio/")?a(f):alert("Select audio/mpeg file")},ae=async S=>{S.preventDefault();try{await h({variables:{title:r,author:l,file:e},refetchQueries:[{query:V}]}),t(),c(""),o("")}catch(f){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",f)}};return te?n(Ze,{}):s("form",{className:E.form,action:"",onSubmit:ae,children:[n("h1",{children:"Upload Track"}),n(j,{inputState:l,setInputState:c,labelText:"Author"}),n(j,{inputState:r,setInputState:o,labelText:"Title"}),s("label",{children:[n("h1",{className:E.uploadTitle,children:"Upload audio File"}),n("input",{required:!0,type:"file",accept:"audio/*",onChange:ne})]}),n(Z,{className:E.btn,type:"submit",children:"Upload Track"})]})},tt="_uploadModal_16r2l_1";var nt={uploadModal:tt};const at=({isOpen:t,onClose:e})=>n(Xe,{className:nt.uploadModal,open:t,onClose:e,children:n(et,{onSubmit:e})}),ot=({})=>{const{data:t,loading:e,error:a}=M(V),[r,o]=i.exports.useState(!1),l=()=>o(!1),c=()=>o(!0),h=t==null?void 0:t.getAllTracks;return a?n(L,{children:n(Ne,{})}):e||!h?n(L,{childsCenter:!0,children:n(Y,{})}):s("div",{className:$.playlist,children:[s("div",{className:$.head,children:[n("h1",{className:$.title,children:`Playlist: ${h.length}`}),n(Z,{onClick:c,children:"Add new track"})]}),n(De,{data:h}),n(at,{isOpen:r,onClose:l})]})},rt="_player_1x5nx_1",lt="_musicImage_1x5nx_55";var U={player:rt,musicImage:lt};const it="_rewindControls_16ji3_1",st="_button_16ji3_13",ct="_toggleButton_16ji3_41",dt="_toggleIcon_16ji3_59",ut="_arrowIcon_16ji3_67",mt="_inverse_16ji3_75";var u={rewindControls:it,button:st,toggleButton:ct,toggleIcon:dt,arrowIcon:ut,inverse:mt};const pt=t=>i.exports.createElement("svg",p({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 485 485",style:{enableBackground:"new 0 0 485 485"},xmlSpace:"preserve",width:"1em",height:"1em"},t),i.exports.createElement("g",null,i.exports.createElement("path",{d:"M413.974,71.026C368.171,25.225,307.274,0,242.5,0S116.829,25.225,71.026,71.026C25.225,116.829,0,177.726,0,242.5 s25.225,125.671,71.026,171.474C116.829,459.775,177.726,485,242.5,485s125.671-25.225,171.474-71.026 C459.775,368.171,485,307.274,485,242.5S459.775,116.829,413.974,71.026z M242.5,455C125.327,455,30,359.673,30,242.5 S125.327,30,242.5,30S455,125.327,455,242.5S359.673,455,242.5,455z"}),i.exports.createElement("rect",{x:172.5,y:140,width:55,height:205}),i.exports.createElement("rect",{x:257.5,y:140,width:55,height:205}))),kt=t=>i.exports.createElement("svg",p({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 485 485",style:{enableBackground:"new 0 0 485 485"},xmlSpace:"preserve",width:"1em",height:"1em"},t),i.exports.createElement("g",null,i.exports.createElement("path",{d:"M413.974,71.026C368.171,25.225,307.274,0,242.5,0S116.829,25.225,71.026,71.026C25.225,116.829,0,177.726,0,242.5 s25.225,125.671,71.026,171.474C116.829,459.775,177.726,485,242.5,485s125.671-25.225,171.474-71.026 C459.775,368.171,485,307.274,485,242.5S459.775,116.829,413.974,71.026z M242.5,455C125.327,455,30,359.673,30,242.5 S125.327,30,242.5,30S455,125.327,455,242.5S359.673,455,242.5,455z"}),i.exports.createElement("polygon",{points:"181.062,336.575 343.938,242.5 181.062,148.425  "}))),q=t=>i.exports.createElement("svg",p({id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 224.175 224.175",style:{enableBackground:"new 0 0 224.175 224.175"},xmlSpace:"preserve",width:"1em",height:"1em"},t),i.exports.createElement("g",null,i.exports.createElement("path",{d:"M185.513,0L185.513,0c-7.4,0-13.7,6.3-13.7,14.2v71.9L46.213,2.2c-2.1-1-4.7-2.1-7.9-2.1c-7.4,0-13.7,6.3-13.7,14.2V210 c0,11,12.6,17.8,21.5,11.5l125.6-83.4V210c-0.5,18.9,28.4,18.9,27.8,0V14.3C200.213,6.3,193.413,0,185.513,0z M52.513,183.7V39.9 l108.2,71.9L52.513,183.7z"}))),{prevTrack:ht,nextTrack:_t,toggleAudio:gt,isPlayingVar:vt}=N,yt=({})=>{const{data:t}=M(V),e=t==null?void 0:t.getAllTracks,a=k(vt);return s(W,{children:[n("button",{className:m(u.button,u.toggleButton),onClick:()=>gt(),children:a?n(pt,{className:u.toggleIcon}):n(kt,{className:u.toggleIcon})}),s("div",{className:u.rewindControls,children:[n("button",{className:u.button,onClick:()=>ht(e),children:n(q,{className:m(u.arrowIcon,u.inverse)})}),n("button",{className:u.button,onClick:()=>_t(e),children:n(q,{className:u.arrowIcon})})]})]})},ft="_box_1x3q1_1",xt="_title_1x3q1_19";var O={box:ft,title:xt};const{volumeVar:ee,audio:z}=N,bt=t=>{const e=+t.target.value/100;ee(e)},Nt=({})=>{const t=k(ee),e=Math.round(t*100);return i.exports.useEffect(()=>{z.volume=t},[]),i.exports.useEffect(()=>{z.volume=t},[t]),s("div",{className:O.box,children:[s("p",{className:O.title,children:["Volume: ",e,"%"]}),n("input",{type:"range",value:e,onChange:a=>bt(a)})]})},wt="_box_r74l1_1",Tt="_image_r74l1_21";var X={box:wt,image:Tt},Vt="/music-playlist-fullstack/assets/music-icon.4498a0e2.svg";const St=a=>{var r=a,{className:t}=r,e=g(r,["className"]);return n("div",x(p({className:m(X.box,t)},e),{children:n("img",{className:X.image,src:Vt,alt:"music"})}))},G=t=>t<10?`0${t}`:`${t}`,K=t=>{const e=Math.floor(t/60),a=Math.floor(t%60);return`${G(e)}:${G(a)}`},Ct="_info_px7rt_1",$t="_box_px7rt_9",Et="_title_px7rt_23";var b={info:Ct,box:$t,title:Et};const{currentTimeVar:Q,canChangeTimeVar:It,audio:Mt,durationVar:At,currentTrackVar:Bt}=N,Pt=(t,e)=>Math.round(t*100/e)?Math.round(t*100/e):0,Ft=({})=>{const t=k(It),e=k(At),a=k(Bt),r=l=>{if(t){const c=+l.target.value*e/100;Q(c),Mt.currentTime=c}},o=k(Q);return s("div",{className:b.info,children:[s("div",{className:b.box,children:[n("h2",{className:b.title,children:a==null?void 0:a.title}),n("p",{children:K(e)})]}),s("div",{className:b.box,children:[n("h3",{className:b.title,children:a==null?void 0:a.author}),n("p",{children:K(o)})]}),n("input",{type:"range",disabled:!t,onChange:r,value:Pt(o,e)})]})},Lt=200,{audio:_,durationVar:Dt,currentTrackVar:jt,currentTimeVar:Rt,canChangeTimeVar:H,nextTrack:Ut,toggleAudio:J}=N,qt=({})=>{const t=k(jt),{data:e}=M(V),a=e==null?void 0:e.getAllTracks,r=o=>{if(!!_.src)switch(o.code){case"Space":o.preventDefault(),J();break}};return i.exports.useEffect(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)),[]),i.exports.useEffect(()=>{t&&(_.src=t.src,_.ontimeupdate=()=>Rt(_.currentTime),_.onloadeddata=()=>{setTimeout(()=>{H(!0)},Lt),Dt(_.duration)},_.onended=()=>{H(!1),Ut(a)},J())},[t]),t?(console.log("render player"),s("div",{className:U.player,children:[n(yt,{}),n(St,{className:U.musicImage}),n(Ft,{}),n(Nt,{})]})):null},Ot=()=>s("div",{className:"container",children:[n("header",{children:n(qt,{})}),n("main",{children:n(ot,{})})]}),zt="https://eyes-closed-server.herokuapp.com/graphql",Xt=de({uri:zt}),Gt=new ue,Kt=new me({link:Xt,cache:Gt});pe.render(n(ke.StrictMode,{children:n(he,{client:Kt,children:n(Ot,{})})}),document.getElementById("root"));
