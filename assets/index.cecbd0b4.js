var le=Object.defineProperty,se=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var z=(n,t,o)=>t in n?le(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,B=(n,t)=>{for(var o in t||(t={}))U.call(t,o)&&z(n,o,t[o]);if($)for(var o of $(t))R.call(t,o)&&z(n,o,t[o]);return n},M=(n,t)=>se(n,re(t));var C=(n,t)=>{var o={};for(var l in n)U.call(n,l)&&t.indexOf(l)<0&&(o[l]=n[l]);if(n!=null&&$)for(var l of $(n))t.indexOf(l)<0&&R.call(n,l)&&(o[l]=n[l]);return o};import{j as V,c as b,g as Y,a as ae,I as ce,A as ie,m as k,u as g,r as de,b as y,d as ue,e as Z,F as w,f as me,h as pe,i as _e,k as he,l as fe,R as ge,n as ye,o as ve}from"./vendor.07c8edb2.js";const xe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}};xe();const be="_playlist_dy7d3_1",ke="_title_dy7d3_23",Ne="_head_dy7d3_33",Te="_btn_dy7d3_45";var P={playlist:be,title:ke,head:Ne,btn:Te};const $e="_title_xynlk_1";var Be={title:$e};const e=V.exports.jsx,c=V.exports.jsxs,L=V.exports.Fragment,Ce=()=>e("div",{children:e("p",{className:Be.title,children:"Connection Error"})}),Ie="_block_11qbe_1";var Se={block:Ie};const j=l=>{var s=l,{children:n,className:t}=s,o=C(s,["children","className"]);return e("div",M(B({className:b(Se.block,t)},o),{children:n}))},we="_loadingWrapper_flrcn_1",Ae="_loading_flrcn_1",Me="_load_flrcn_1";var O={loadingWrapper:we,loading:Ae,load:Me};const ee=()=>e("div",{className:O.loadingWrapper,children:e("div",{className:O.loading})}),te=Y`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,Pe="_tracksBlock_diz2w_1";var Fe={tracksBlock:Pe};const Ee="_track_dy45d_1",Le="_info_dy45d_41",Ve="_innerBox_dy45d_61",qe="_text_dy45d_69",ze="_active_dy45d_89",Ue="_trackBox_dy45d_107";var p={track:Ee,info:Le,innerBox:Ve,text:qe,active:ze,trackBox:Ue};const Re=({title:n,active:t,subtitle:o,onClick:l})=>c("button",{onClick:()=>l(),className:b(p.track,{[p.active]:t}),children:[e("div",{className:p.trackBox}),c("div",{className:p.info,children:[e("div",{className:p.innerBox,children:e("h2",{className:p.text,children:n})}),e("div",{className:p.innerBox,children:e("h3",{className:p.text,children:o})})]})]}),_=k(null),F=k(!1),D=k(1),E=k(0),W=k(0),je="https://eyes-closed-server.herokuapp.com/graphql",Oe=ae({uri:je}),De=new ce,We=new ie({link:Oe,cache:De}),Ke=({data:n})=>{const t=g(_),o=l=>()=>_(l);return e("ul",{className:Fe.tracksBlock,children:n.map(l=>e("li",{children:e(Re,{active:l.id===(t==null?void 0:t.id),onClick:o(l),title:l.title,subtitle:l.author})},l.id))})},Ge="_button_ptj0d_1";var He={button:Ge};const ne=l=>{var s=l,{children:n,className:t}=s,o=C(s,["children","className"]);return e("button",M(B({className:b(He.button,t)},o),{children:n}))},Qe="_modal_1pv5q_1",Je="_overlay_1pv5q_27";var K={modal:Qe,overlay:Je};const G=document.getElementById("modal"),Xe=({className:n,children:t,open:o,onClose:l})=>!o||!G?e(L,{}):de.exports.createPortal(c(L,{children:[e("div",{onClick:l,className:K.overlay}),e("div",{className:b(K.modal,n),children:t})]}),G),Ye="_form_glkez_1",Ze="_btn_glkez_19",et="_uploadTitle_glkez_31",tt="_loadingTitle_glkez_43";var I={form:Ye,btn:Ze,uploadTitle:et,loadingTitle:tt};const nt=Y`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,ot="_input_uv6sf_1";var lt={input:ot};const H=y.exports.memo(r=>{var a=r,{inputState:n,setInputState:t,labelText:o,className:l}=a,s=C(a,["inputState","setInputState","labelText","className"]);return c("label",{children:[e("h3",{children:o}),e("input",B({required:!0,className:b(lt.input,l),value:n,onChange:m=>t(m.target.value),type:"text"},s))]})}),st=({onSubmit:n})=>{const[t,o]=y.exports.useState(null),[l,s]=y.exports.useState(""),[r,a]=y.exports.useState(""),[m,{loading:N}]=ue(nt),A=v=>{var i;const d=(i=v.target.files)==null?void 0:i[0];d&&d.type.includes("audio/")?o(d):alert("Select audio/mpeg file")},T=async v=>{v.preventDefault();try{const{data:d}=await m({variables:{title:l,author:r,file:t}}),i=d==null?void 0:d.addTrack;console.log(i),n(),a(""),s("")}catch(d){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",d)}};return N?c(L,{children:[e("p",{className:I.loadingTitle,children:"Uploading track. Please wait."}),e(ee,{})]}):c("form",{className:I.form,action:"",onSubmit:T,children:[e("h1",{children:"Upload Track"}),e(H,{inputState:r,setInputState:a,labelText:"Author"}),e(H,{inputState:l,setInputState:s,labelText:"Title"}),c("label",{children:[e("h1",{className:I.uploadTitle,children:"Upload audio File"}),e("input",{required:!0,type:"file",accept:"audio/*",onChange:A})]}),e(ne,{className:I.btn,type:"submit",children:"Upload Track"})]})},rt=()=>{const{data:n,loading:t,error:o}=Z(te),[l,s]=y.exports.useState(!1),r=n==null?void 0:n.getAllTracks;if(o)return e(j,{children:e(Ce,{})});if(t||!r)return e(j,{children:e(ee,{})});const a=()=>()=>s(!0),m=()=>()=>s(!1);return c("section",{className:P.playlist,children:[c("div",{className:P.head,children:[e("h1",{className:P.title,children:`Playlist: ${r.length}`}),e(ne,{onClick:a(),children:"Add new track"})]}),e(Ke,{data:r}),e(Xe,{open:l,onClose:m(),children:e(st,{onSubmit:m()})})]})},at="_player_1ro2p_1",ct="_musicImage_1ro2p_59";var Q={player:at,musicImage:ct};const it="_wrapper_1urm7_1",dt="_rewindControls_1urm7_19",ut="_musicImage_1urm7_29",mt="_button_1urm7_37";var h={wrapper:it,rewindControls:dt,musicImage:ut,button:mt};const pt="_box_dmcht_1";var _t={box:pt};const oe=()=>e("div",{className:_t.box,children:e(w,{style:{fontSize:"1.7rem"},icon:me,color:"black"})}),ht=({toggleAudio:n,nextTrack:t,prevTrack:o,playing:l})=>c("div",{className:h.wrapper,children:[e("div",{className:h.musicImage,children:e(oe,{})}),e("button",{className:h.button,onClick:()=>n(),children:e(w,{size:"3x",icon:l?pe:_e,color:"black"})}),c("div",{className:h.rewindControls,children:[e("button",{className:h.button,onClick:()=>o(),children:e(w,{size:"2x",icon:he,color:"black"})}),e("button",{className:h.button,onClick:()=>t(),children:e(w,{size:"2x",icon:fe,color:"black"})})]})]}),ft="_box_e863m_1",gt="_title_e863m_17";var J={box:ft,title:gt};const yt=({volumeState:n,handleVolume:t})=>c("div",{className:J.box,children:[c("p",{className:J.title,children:["Volume: ",Math.round(n*100),"%"]}),e("input",{className:"clickable",type:"range",value:Math.round(n*100),onChange:o=>t(o)})]}),X=n=>{const t=Math.floor(n/60),o=Math.floor(n%60),l=t<10?`0${t}`:`${t}`,s=o<10?`0${o}`:`${o}`;return`${l}:${s}`},vt="_infoInnerBox_1xn2v_1",xt="_title_1xn2v_13",bt="_progressBar_1xn2v_29",kt="_info_1xn2v_1";var f={infoInnerBox:vt,title:xt,progressBar:bt,info:kt};const Nt=({track:n,duration:t,currentTime:o,handleProgress:l,canChangeTime:s})=>c("div",{className:f.info,children:[c("div",{className:f.infoInnerBox,children:[e("h2",{className:f.title,children:n==null?void 0:n.title}),e("p",{children:X(t)})]}),c("div",{className:f.infoInnerBox,children:[e("h3",{className:f.title,children:n==null?void 0:n.author}),e("p",{children:X(o)})]}),e("input",{className:f.progressBar,type:"range",disabled:!s,onChange:l,value:t?Math.round(o*100/t):0})]});let u=new Audio,S=!0;const Tt=200,$t=()=>{const n=g(W),t=g(_),o=g(E),l=g(F),s=g(D),{data:r}=Z(te),a=r==null?void 0:r.getAllTracks,m=()=>{if(!a||!t)return;const i=a.indexOf(t);_(i===0?a[a.length-1]:a[i-1])},N=()=>{if(!a||!t)return;const i=a.indexOf(t);i===a.length-1?_(a[0]):_(a[i+1])},A=()=>N();y.exports.useEffect(()=>{t&&(u.src=t.src,u.ontimeupdate=()=>E(u.currentTime),u.onloadeddata=()=>{setTimeout(()=>{S=!0},Tt),W(u.duration)},u.onended=()=>{S=!1,A()},T())},[t]);const T=async()=>{if(u.paused){F(!0);try{await u.play()}catch(i){console.log(i)}}else F(!1),u.pause()},v=i=>{const q=+i.target.value;if(S){const x=q*n/100;u.currentTime=x,E(x)}},d=i=>{const x=+i.target.value/100;D(x),u.volume=x};return t?c("div",{className:Q.player,children:[e(ht,{toggleAudio:T,nextTrack:N,prevTrack:m,playing:l}),e("div",{className:Q.musicImage,children:e(oe,{})}),e(Nt,{track:t,duration:n,currentTime:o,handleProgress:v,canChangeTime:S}),e(yt,{volumeState:s,handleVolume:d})]}):null},Bt=()=>c("div",{className:"container",children:[e($t,{}),e(rt,{})]});ge.render(e(ye.StrictMode,{children:e(ve,{client:We,children:e(Bt,{})})}),document.getElementById("root"));
