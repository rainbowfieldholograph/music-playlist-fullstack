var le=Object.defineProperty,ie=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var O=(e,t,o)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,b=(e,t)=>{for(var o in t||(t={}))q.call(t,o)&&O(e,o,t[o]);if($)for(var o of $(t))R.call(t,o)&&O(e,o,t[o]);return e},B=(e,t)=>ie(e,se(t));var N=(e,t)=>{var o={};for(var a in e)q.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(e!=null&&$)for(var a of $(e))t.indexOf(a)<0&&R.call(e,a)&&(o[a]=e[a]);return o};import{j as L,c as p,m as T,u as y,r as m,a as re,f as ce,b as de,d as te,F,e as ue,g as me,h as pe,i as ke,k as _e,l as he,I as fe,A as ve,R as ye,n as ge,o as be}from"./vendor.d55effdf.js";const Ne=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function o(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerpolicy&&(i.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?i.credentials="include":l.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(l){if(l.ep)return;l.ep=!0;const i=o(l);fetch(l.href,i)}};Ne();const xe="_playlist_dy7d3_1",Te="_title_dy7d3_23",Se="_head_dy7d3_33",we="_btn_dy7d3_45";var E={playlist:xe,title:Te,head:Se,btn:we};const $e="_title_xynlk_1";var Be={title:$e};const n=L.exports.jsx,r=L.exports.jsxs,ne=L.exports.Fragment,Ce=o=>{var a=o,{className:e}=a,t=N(a,["className"]);return n("div",B(b({className:e},t),{children:n("p",{className:Be.title,children:"Connection Error"})}))},Ie="_block_cfywl_1",Fe="_center_cfywl_9";var z={block:Ie,center:Fe};const G=l=>{var i=l,{children:e,className:t,childsCenter:o}=i,a=N(i,["children","className","childsCenter"]);return n("div",B(b({className:p(z.block,t,{[z.center]:o})},a),{children:e}))},Ae="_loading_clven_1",Me="_load_clven_1";var Ee={loading:Ae,load:Me};const oe=({className:e})=>n("div",{className:p(Ee.loading,e)}),Ve="_tracksBlock_diz2w_1";var Pe={tracksBlock:Ve};const De="_track_i18so_1",Le="_info_i18so_39",je="_text_i18so_53",Ue="_active_i18so_71",Oe="_trackBox_i18so_85";var f={track:De,info:Le,text:je,active:Ue,trackBox:Oe};const qe=({title:e,active:t,subtitle:o,onClick:a})=>r("button",{onClick:()=>a(),className:p(f.track,{[f.active]:t}),children:[n("div",{className:f.trackBox}),r("div",{className:f.info,children:[n("span",{children:n("h2",{className:f.text,children:e})}),n("div",{children:n("h3",{className:f.text,children:o})})]})]}),h=T(null),V=T(!1),K=T(.5),P=T(0),Q=T(0),Re=({data:e})=>{const t=y(h),o=a=>()=>h(a);return n("ul",{className:Pe.tracksBlock,children:e.map(a=>n("li",{children:n(qe,{active:a.id===(t==null?void 0:t.id),onClick:o(a),title:a.title,subtitle:a.author})},a.id))})},ze="_button_ptj0d_1";var Ge={button:ze};const ae=a=>{var l=a,{children:e,className:t}=l,o=N(l,["children","className"]);return n("button",B(b({className:p(Ge.button,t)},o),{children:e}))},Ke={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"addTrack"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"author"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"file"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addTrack"},arguments:[{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"author"},value:{kind:"Variable",name:{kind:"Name",value:"author"}}},{kind:"Argument",name:{kind:"Name",value:"file"},value:{kind:"Variable",name:{kind:"Name",value:"file"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"src"}},{kind:"Field",name:{kind:"Name",value:"author"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},j={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetAllTracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getAllTracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"author"}},{kind:"Field",name:{kind:"Name",value:"src"}}]}}]}}]},Qe="__lock_1up8e_1",He="_modal_1up8e_9",Je="_overlay_1up8e_41";var C={_lock:Qe,modal:He,overlay:Je};const H=document.getElementById("modal"),We=({className:e,children:t,open:o,onClose:a})=>{const l=i=>{console.log("click"),(i.key==="Esc"||i.key==="Escape")&&a()};return m.exports.useEffect(()=>{document.body.classList.add(C._lock)},[]),m.exports.useEffect(()=>{if(document.body.classList.toggle(C._lock),o)return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[o]),!o||!H?n(ne,{}):re.exports.createPortal(n(ce,{children:n("div",{onClick:()=>a(),className:C.overlay,children:n("div",{onClick:i=>i.stopPropagation(),role:"dialog",className:p(C.modal,e),children:t})})}),H)},Xe="_form_1mtor_1",Ye="_btn_1mtor_15",Ze="_uploadTitle_1mtor_27";var D={form:Xe,btn:Ye,uploadTitle:Ze};const et="_input_uv6sf_1";var tt={input:et};const J=i=>{var s=i,{inputState:e,setInputState:t,labelText:o,className:a}=s,l=N(s,["inputState","setInputState","labelText","className"]);return r("label",{children:[n("h3",{children:o}),n("input",b({required:!0,className:p(tt.input,a),value:e,onChange:u=>t(u.target.value),type:"text"},l))]})},nt="_block_r92fe_1",ot="_title_r92fe_17";var W={block:nt,title:ot};const at=({title:e="Uploading track. Please wait.",className:t})=>r("div",{className:p(W.block,t),children:[n("p",{className:W.title,children:e}),n(oe,{})]}),lt=({onSubmit:e})=>{const[t,o]=m.exports.useState(null),[a,l]=m.exports.useState(""),[i,s]=m.exports.useState(""),[u,{loading:A}]=de(Ke),S=k=>{var w;const _=(w=k.target.files)==null?void 0:w[0];_&&_.type.includes("audio/")?o(_):alert("Select audio/mpeg file")},M=async k=>{k.preventDefault();try{await u({variables:{title:a,author:i,file:t},refetchQueries:[{query:j}]}),e(),s(""),l("")}catch(_){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",_)}};return A?n(at,{}):r("form",{className:D.form,action:"",onSubmit:M,children:[n("h1",{children:"Upload Track"}),n(J,{inputState:i,setInputState:s,labelText:"Author"}),n(J,{inputState:a,setInputState:l,labelText:"Title"}),r("label",{children:[n("h1",{className:D.uploadTitle,children:"Upload audio File"}),n("input",{required:!0,type:"file",accept:"audio/*",onChange:S})]}),n(ae,{className:D.btn,type:"submit",children:"Upload Track"})]})},it="_uploadModal_16r2l_1";var st={uploadModal:it};const rt=({isOpen:e,onClose:t})=>n(We,{className:st.uploadModal,open:e,onClose:t,children:n(lt,{onSubmit:t})}),ct=({})=>{const{data:e,loading:t,error:o}=te(j),[a,l]=m.exports.useState(!1),i=()=>l(!1),s=()=>l(!0),u=e==null?void 0:e.getAllTracks;return o?n(G,{children:n(Ce,{})}):t||!u?n(G,{childsCenter:!0,children:n(oe,{})}):r("section",{className:E.playlist,children:[r("div",{className:E.head,children:[n("h1",{className:E.title,children:`Playlist: ${u.length}`}),n(ae,{onClick:s,children:"Add new track"})]}),n(Re,{data:u}),n(rt,{isOpen:a,onClose:i})]})},dt="_player_1x5nx_1",ut="_musicImage_1x5nx_55";var X={player:dt,musicImage:ut};const mt="_rewindControls_1mt0o_1",pt="_button_1mt0o_13",kt="_toggleButton_1mt0o_35";var x={rewindControls:mt,button:pt,toggleButton:kt};const _t=({toggleAudio:e,nextTrack:t,prevTrack:o,playing:a})=>r(ne,{children:[n("button",{className:p(x.button,x.toggleButton),onClick:()=>e(),children:n(F,{size:"3x",icon:a?ue:me,color:"black"})}),r("div",{className:x.rewindControls,children:[n("button",{className:x.button,onClick:()=>o(),children:n(F,{size:"2x",icon:pe,color:"black"})}),n("button",{className:x.button,onClick:()=>t(),children:n(F,{size:"2x",icon:ke,color:"black"})})]})]}),ht="_box_1x3q1_1",ft="_title_1x3q1_19";var Y={box:ht,title:ft};const vt=({volumeState:e,handleVolume:t})=>r("div",{className:Y.box,children:[r("p",{className:Y.title,children:["Volume: ",Math.round(e*100),"%"]}),n("input",{className:"clickable",type:"range",value:Math.round(e*100),onChange:o=>t(o)})]}),yt="_box_hh6i4_1";var gt={box:yt};const bt=({})=>n("div",{className:gt.box,children:n(F,{style:{fontSize:"1.7rem"},icon:_e,color:"black"})}),Z=e=>e<10?`0${e}`:`${e}`,ee=e=>{const t=Math.floor(e/60),o=Math.floor(e%60);return`${Z(t)}:${Z(o)}`},Nt="_infoInnerBox_jt7d9_1",xt="_title_jt7d9_13",Tt="_progressBar_jt7d9_29",St="_info_jt7d9_1";var v={infoInnerBox:Nt,title:xt,progressBar:Tt,info:St};const wt=({track:e,duration:t,currentTime:o,handleProgress:a,canChangeTime:l})=>r("div",{className:v.info,children:[r("div",{className:v.infoInnerBox,children:[n("h2",{className:v.title,children:e==null?void 0:e.title}),n("p",{children:ee(t)})]}),r("div",{className:v.infoInnerBox,children:[n("h3",{className:v.title,children:e==null?void 0:e.author}),n("p",{children:ee(o)})]}),n("input",{className:v.progressBar,type:"range",disabled:!l,onChange:a,value:t?Math.round(o*100/t):0})]});let d=new Audio,I=!0;const $t=200,Bt=({})=>{const e=y(Q),t=y(h),o=y(P),a=y(V),l=y(K),{data:i}=te(j),s=i==null?void 0:i.getAllTracks,u=c=>{if(!!d.src)switch(c.code){case"Space":c.preventDefault(),k();break}};m.exports.useEffect(()=>(d.volume=l,window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[]);const A=()=>{if(!s||!t)return;const c=s.indexOf(t);h(c===0?s[s.length-1]:s[c-1])},S=()=>{if(!s||!t)return;const c=s.indexOf(t);c===s.length-1?h(s[0]):h(s[c+1])},M=()=>S();m.exports.useEffect(()=>{t&&(d.src=t.src,d.ontimeupdate=()=>P(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{I=!0},$t),Q(d.duration)},d.onended=()=>{I=!1,M()},k())},[t]);const k=async()=>{if(d.paused){V(!0);try{await d.play()}catch(c){console.log(c)}}else V(!1),d.pause()},_=c=>{const U=+c.target.value;if(I){const g=U*e/100;d.currentTime=g,P(g)}},w=c=>{const g=+c.target.value/100;K(g),d.volume=g};return t?r("div",{className:X.player,children:[n(_t,{toggleAudio:k,nextTrack:S,prevTrack:A,playing:a}),n("div",{className:X.musicImage,children:n(bt,{})}),n(wt,{track:t,duration:e,currentTime:o,handleProgress:_,canChangeTime:I}),n(vt,{volumeState:l,handleVolume:w})]}):null},Ct=()=>r("div",{className:"container",children:[n(Bt,{}),n(ct,{})]}),It="https://eyes-closed-server.herokuapp.com/graphql",Ft=he({uri:It}),At=new fe,Mt=new ve({link:Ft,cache:At});ye.render(n(ge.StrictMode,{children:n(be,{client:Mt,children:n(Ct,{})})}),document.getElementById("root"));
