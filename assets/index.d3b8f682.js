var ae=Object.defineProperty,ce=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var R=(e,o,n)=>o in e?ae(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,k=(e,o)=>{for(var n in o||(o={}))j.call(o,n)&&R(e,n,o[n]);if(B)for(var n of B(o))O.call(o,n)&&R(e,n,o[n]);return e},C=(e,o)=>ce(e,ie(o));var N=(e,o)=>{var n={};for(var s in e)j.call(e,s)&&o.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&B)for(var s of B(e))o.indexOf(s)<0&&O.call(e,s)&&(n[s]=e[s]);return n};import{j as U,c as y,g as oe,a as de,I as ue,A as me,m as $,u as x,r as m,b as _e,d as pe,e as ne,F as M,f as he,h as fe,i as ye,k as ve,l as ge,R as xe,n as be,o as ke}from"./vendor.402c6bd1.js";const Ne=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}};Ne();const $e="_playlist_11scu_1",Te="_title_11scu_23",we="_head_11scu_33",Be="_uploadModal_11scu_45",Ce="_btn_11scu_57";var I={playlist:$e,title:Te,head:we,uploadModal:Be,btn:Ce};const Ie="_title_xynlk_1";var Se={title:Ie};const t=U.exports.jsx,c=U.exports.jsxs,z=U.exports.Fragment,Ae=n=>{var s=n,{className:e}=s,o=N(s,["className"]);return t("div",C(k({className:e},o),{children:t("p",{className:Se.title,children:"Connection Error"})}))},Me="_block_cfywl_1",Pe="_center_cfywl_9";var K={block:Me,center:Pe};const G=l=>{var r=l,{children:e,className:o,childsCenter:n}=r,s=N(r,["children","className","childsCenter"]);return t("div",C(k({className:y(K.block,o,{[K.center]:n})},s),{children:e}))},Ee="_loading_clven_1",Le="_load_clven_1";var Fe={loading:Ee,load:Le};const se=({className:e})=>t("div",{className:y(Fe.loading,e)}),V=oe`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,qe="_tracksBlock_diz2w_1";var Ue={tracksBlock:qe};const Ve="_track_dy45d_1",De="_info_dy45d_41",Re="_innerBox_dy45d_61",je="_text_dy45d_69",Oe="_active_dy45d_89",ze="_trackBox_dy45d_107";var _={track:Ve,info:De,innerBox:Re,text:je,active:Oe,trackBox:ze};const Ke=({title:e,active:o,subtitle:n,onClick:s})=>c("button",{onClick:()=>s(),className:y(_.track,{[_.active]:o}),children:[t("div",{className:_.trackBox}),c("div",{className:_.info,children:[t("div",{className:_.innerBox,children:t("h2",{className:_.text,children:e})}),t("div",{className:_.innerBox,children:t("h3",{className:_.text,children:n})})]})]}),f=$(null),L=$(!1),Q=$(.8),F=$(0),H=$(0),Ge="https://eyes-closed-server.herokuapp.com/graphql",Qe=de({uri:Ge}),He=new ue,Je=new me({link:Qe,cache:He}),We=({data:e})=>{const o=x(f),n=s=>()=>f(s);return t("ul",{className:Ue.tracksBlock,children:e.map(s=>t("li",{children:t(Ke,{active:s.id===(o==null?void 0:o.id),onClick:n(s),title:s.title,subtitle:s.author})},s.id))})},Xe="_button_ptj0d_1";var Ye={button:Xe};const le=s=>{var l=s,{children:e,className:o}=l,n=N(l,["children","className"]);return t("button",C(k({className:y(Ye.button,o)},n),{children:e}))},Ze="__lock_rqvxe_1",et="_modal_rqvxe_9",tt="_overlay_rqvxe_39";var S={_lock:Ze,modal:et,overlay:tt};const J=document.getElementById("modal"),ot=({className:e,children:o,open:n,onClose:s})=>(m.exports.useEffect(()=>{document.body.classList.add(S._lock)},[]),m.exports.useEffect(()=>{document.body.classList.toggle(S._lock)},[n]),!n||!J?t(z,{}):_e.exports.createPortal(c(z,{children:[t("div",{onClick:s,className:S.overlay}),t("div",{className:y(S.modal,e),children:o})]}),J)),nt="_form_1mtor_1",st="_btn_1mtor_15",lt="_uploadTitle_1mtor_27";var q={form:nt,btn:st,uploadTitle:lt};const rt=oe`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,at="_input_uv6sf_1";var ct={input:at};const W=m.exports.memo(r=>{var a=r,{inputState:e,setInputState:o,labelText:n,className:s}=a,l=N(a,["inputState","setInputState","labelText","className"]);return c("label",{children:[t("h3",{children:n}),t("input",k({required:!0,className:y(ct.input,s),value:e,onChange:u=>o(u.target.value),type:"text"},l))]})}),it="_block_r92fe_1",dt="_title_r92fe_17";var X={block:it,title:dt};const ut=({title:e="Uploading track. Please wait.",className:o})=>c("div",{className:y(X.block,o),children:[t("p",{className:X.title,children:e}),t(se,{})]}),mt=({onSubmit:e})=>{const[o,n]=m.exports.useState(null),[s,l]=m.exports.useState(""),[r,a]=m.exports.useState(""),[u,{loading:P}]=pe(rt),T=p=>{var w;const h=(w=p.target.files)==null?void 0:w[0];h&&h.type.includes("audio/")?n(h):alert("Select audio/mpeg file")},E=async p=>{p.preventDefault();try{await u({variables:{title:s,author:r,file:o},refetchQueries:[{query:V}]}),e(),a(""),l("")}catch(h){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",h)}};return P?t(ut,{}):c("form",{className:q.form,action:"",onSubmit:E,children:[t("h1",{children:"Upload Track"}),t(W,{inputState:r,setInputState:a,labelText:"Author"}),t(W,{inputState:s,setInputState:l,labelText:"Title"}),c("label",{children:[t("h1",{className:q.uploadTitle,children:"Upload audio File"}),t("input",{required:!0,type:"file",accept:"audio/*",onChange:T})]}),t(le,{className:q.btn,type:"submit",children:"Upload Track"})]})},_t=()=>{const{data:e,loading:o,error:n}=ne(V),[s,l]=m.exports.useState(!1),r=e==null?void 0:e.getAllTracks;if(n)return t(G,{children:t(Ae,{})});if(o||!r)return t(G,{childsCenter:!0,children:t(se,{})});const a=()=>()=>l(!0),u=()=>()=>l(!1);return c("section",{className:I.playlist,children:[c("div",{className:I.head,children:[t("h1",{className:I.title,children:`Playlist: ${r.length}`}),t(le,{onClick:a(),children:"Add new track"})]}),t(We,{data:r}),t(ot,{className:I.uploadModal,open:s,onClose:u(),children:t(mt,{onSubmit:u()})})]})},pt="_player_1glm3_1",ht="_musicImage_1glm3_57";var Y={player:pt,musicImage:ht};const ft="_wrapper_sfmsf_1",yt="_rewindControls_sfmsf_19",vt="_musicImage_sfmsf_29",gt="_button_sfmsf_37";var v={wrapper:ft,rewindControls:yt,musicImage:vt,button:gt};const xt="_box_dmcht_1";var bt={box:xt};const re=()=>t("div",{className:bt.box,children:t(M,{style:{fontSize:"1.7rem"},icon:he,color:"black"})}),kt=({toggleAudio:e,nextTrack:o,prevTrack:n,playing:s})=>c("div",{className:v.wrapper,children:[t("div",{className:v.musicImage,children:t(re,{})}),t("button",{className:v.button,onClick:()=>e(),children:t(M,{size:"3x",icon:s?fe:ye,color:"black"})}),c("div",{className:v.rewindControls,children:[t("button",{className:v.button,onClick:()=>n(),children:t(M,{size:"2x",icon:ve,color:"black"})}),t("button",{className:v.button,onClick:()=>o(),children:t(M,{size:"2x",icon:ge,color:"black"})})]})]}),Nt="_box_e863m_1",$t="_title_e863m_17";var Z={box:Nt,title:$t};const Tt=({volumeState:e,handleVolume:o})=>c("div",{className:Z.box,children:[c("p",{className:Z.title,children:["Volume: ",Math.round(e*100),"%"]}),t("input",{className:"clickable",type:"range",value:Math.round(e*100),onChange:n=>o(n)})]}),ee=e=>e<10?`0${e}`:`${e}`,te=e=>{const o=Math.floor(e/60),n=Math.floor(e%60);return`${ee(o)}:${ee(n)}`},wt="_infoInnerBox_1xn2v_1",Bt="_title_1xn2v_13",Ct="_progressBar_1xn2v_29",It="_info_1xn2v_1";var g={infoInnerBox:wt,title:Bt,progressBar:Ct,info:It};const St=({track:e,duration:o,currentTime:n,handleProgress:s,canChangeTime:l})=>c("div",{className:g.info,children:[c("div",{className:g.infoInnerBox,children:[t("h2",{className:g.title,children:e==null?void 0:e.title}),t("p",{children:te(o)})]}),c("div",{className:g.infoInnerBox,children:[t("h3",{className:g.title,children:e==null?void 0:e.author}),t("p",{children:te(n)})]}),t("input",{className:g.progressBar,type:"range",disabled:!l,onChange:s,value:o?Math.round(n*100/o):0})]});let d=new Audio,A=!0;const At=200,Mt=()=>{const e=x(H),o=x(f),n=x(F),s=x(L),l=x(Q),{data:r}=ne(V),a=r==null?void 0:r.getAllTracks,u=i=>{if(!!d.src)switch(i.code){case"Space":i.preventDefault(),p();break}};m.exports.useEffect(()=>(window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[]);const P=()=>{if(!a||!o)return;const i=a.indexOf(o);f(i===0?a[a.length-1]:a[i-1])},T=()=>{if(!a||!o)return;const i=a.indexOf(o);i===a.length-1?f(a[0]):f(a[i+1])},E=()=>T();m.exports.useEffect(()=>{o&&(d.src=o.src,d.ontimeupdate=()=>F(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{A=!0},At),H(d.duration)},d.onended=()=>{A=!1,E()},p())},[o]);const p=async()=>{if(d.paused){L(!0);try{await d.play()}catch(i){console.log(i)}}else L(!1),d.pause()},h=i=>{const D=+i.target.value;if(A){const b=D*e/100;d.currentTime=b,F(b)}},w=i=>{const b=+i.target.value/100;Q(b),d.volume=b};return o?c("div",{className:Y.player,children:[t(kt,{toggleAudio:p,nextTrack:T,prevTrack:P,playing:s}),t("div",{className:Y.musicImage,children:t(re,{})}),t(St,{track:o,duration:e,currentTime:n,handleProgress:h,canChangeTime:A}),t(Tt,{volumeState:l,handleVolume:w})]}):null},Pt=()=>c("div",{className:"container",children:[t(Mt,{}),t(_t,{})]});xe.render(t(be.StrictMode,{children:t(ke,{client:Je,children:t(Pt,{})})}),document.getElementById("root"));
