var ae=Object.defineProperty,ce=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var q=(e,o,n)=>o in e?ae(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,T=(e,o)=>{for(var n in o||(o={}))O.call(o,n)&&q(e,n,o[n]);if(I)for(var n of I(o))j.call(o,n)&&q(e,n,o[n]);return e},S=(e,o)=>ce(e,ie(o));var w=(e,o)=>{var n={};for(var s in e)O.call(e,s)&&o.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&I)for(var s of I(e))o.indexOf(s)<0&&j.call(e,s)&&(n[s]=e[s]);return n};import{j as R,c as g,g as oe,a as de,I as ue,A as me,m as C,u as N,r as p,b as fe,d as _e,e as ne,F as P,f as pe,h as he,i as ye,k as ve,l as ge,R as be,n as xe,o as ke}from"./vendor.a042739e.js";const Ne=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}};Ne();const $e="_playlist_11scu_1",Te="_title_11scu_23",we="_head_11scu_33",Ce="_uploadModal_11scu_45",Be="_btn_11scu_57";var A={playlist:$e,title:Te,head:we,uploadModal:Ce,btn:Be};const Ie="_title_xynlk_1";var Se={title:Ie};const t=R.exports.jsx,i=R.exports.jsxs,K=R.exports.Fragment,Ae=n=>{var s=n,{className:e}=s,o=w(s,["className"]);return t("div",S(T({className:e},o),{children:t("p",{className:Se.title,children:"Connection Error"})}))},Me="_block_cfywl_1",Ee="_center_cfywl_9";var z={block:Me,center:Ee};const G=l=>{var r=l,{children:e,className:o,childsCenter:n}=r,s=w(r,["children","className","childsCenter"]);return t("div",S(T({className:g(z.block,o,{[z.center]:n})},s),{children:e}))},Pe="_loading_clven_1",Le="_load_clven_1";var Fe={loading:Pe,load:Le};const se=({className:e})=>t("div",{className:g(Fe.loading,e)}),U=oe`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,De="_tracksBlock_diz2w_1";var Re={tracksBlock:De};const Ue="_track_dy45d_1",Ve="_info_dy45d_41",qe="_innerBox_dy45d_61",Oe="_text_dy45d_69",je="_active_dy45d_89",Ke="_trackBox_dy45d_107";var h={track:Ue,info:Ve,innerBox:qe,text:Oe,active:je,trackBox:Ke};const ze=({title:e,active:o,subtitle:n,onClick:s})=>i("button",{onClick:()=>s(),className:g(h.track,{[h.active]:o}),children:[t("div",{className:h.trackBox}),i("div",{className:h.info,children:[t("div",{className:h.innerBox,children:t("h2",{className:h.text,children:e})}),t("div",{className:h.innerBox,children:t("h3",{className:h.text,children:n})})]})]}),v=C(null),L=C(!1),H=C(.8),F=C(0),Q=C(0),Ge="https://eyes-closed-server.herokuapp.com/graphql",He=de({uri:Ge}),Qe=new ue,Je=new me({link:He,cache:Qe}),We=({data:e})=>{const o=N(v),n=s=>()=>v(s);return t("ul",{className:Re.tracksBlock,children:e.map(s=>t("li",{children:t(ze,{active:s.id===(o==null?void 0:o.id),onClick:n(s),title:s.title,subtitle:s.author})},s.id))})},Xe="_button_ptj0d_1";var Ye={button:Xe};const le=s=>{var l=s,{children:e,className:o}=l,n=w(l,["children","className"]);return t("button",S(T({className:g(Ye.button,o)},n),{children:e}))},Ze="__lock_1up8e_1",et="_modal_1up8e_9",tt="_overlay_1up8e_41";var M={_lock:Ze,modal:et,overlay:tt};const J=document.getElementById("modal"),ot=({className:e,children:o,open:n,onClose:s})=>{const l=p.exports.useRef(null),r=c=>{var _;if(c.key!=="Tab")return;const u=(_=l.current)==null?void 0:_.querySelectorAll("a[href], button:not([disabled]), textarea, input, select");if(!u)return;const f=u[0],b=u[u.length-1];if(!c.shiftKey&&document.activeElement===b)return f.focus(),c.preventDefault();c.shiftKey&&document.activeElement===f&&(b.focus(),c.preventDefault())},a=()=>{var f;const c=(f=l.current)==null?void 0:f.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]');if(!c)return;const u=Array.prototype.slice.call(c)[0];u==null||u.focus()};return p.exports.useEffect(()=>{document.body.classList.add(M._lock)},[]),p.exports.useEffect(()=>{n&&a(),document.body.classList.toggle(M._lock)},[n]),!n||!J?t(K,{}):fe.exports.createPortal(i(K,{children:[t("div",{onClick:s,className:M.overlay}),t("div",{ref:l,onKeyDown:r,role:"dialog",className:g(M.modal,e),children:o})]}),J)},nt="_form_1mtor_1",st="_btn_1mtor_15",lt="_uploadTitle_1mtor_27";var D={form:nt,btn:st,uploadTitle:lt};const rt=oe`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,at="_input_uv6sf_1";var ct={input:at};const W=p.exports.memo(r=>{var a=r,{inputState:e,setInputState:o,labelText:n,className:s}=a,l=w(a,["inputState","setInputState","labelText","className"]);return i("label",{children:[t("h3",{children:n}),t("input",T({required:!0,className:g(ct.input,s),value:e,onChange:c=>o(c.target.value),type:"text"},l))]})}),it="_block_r92fe_1",dt="_title_r92fe_17";var X={block:it,title:dt};const ut=({title:e="Uploading track. Please wait.",className:o})=>i("div",{className:g(X.block,o),children:[t("p",{className:X.title,children:e}),t(se,{})]}),mt=({onSubmit:e})=>{const[o,n]=p.exports.useState(null),[s,l]=p.exports.useState(""),[r,a]=p.exports.useState(""),[c,{loading:u}]=_e(rt),f=_=>{var B;const y=(B=_.target.files)==null?void 0:B[0];y&&y.type.includes("audio/")?n(y):alert("Select audio/mpeg file")},b=async _=>{_.preventDefault();try{await c({variables:{title:s,author:r,file:o},refetchQueries:[{query:U}]}),e(),a(""),l("")}catch(y){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",y)}};return u?t(ut,{}):i("form",{className:D.form,action:"",onSubmit:b,children:[t("h1",{children:"Upload Track"}),t(W,{inputState:r,setInputState:a,labelText:"Author"}),t(W,{inputState:s,setInputState:l,labelText:"Title"}),i("label",{children:[t("h1",{className:D.uploadTitle,children:"Upload audio File"}),t("input",{required:!0,type:"file",accept:"audio/*",onChange:f})]}),t(le,{className:D.btn,type:"submit",children:"Upload Track"})]})},ft=()=>{const{data:e,loading:o,error:n}=ne(U),[s,l]=p.exports.useState(!1),r=e==null?void 0:e.getAllTracks;if(n)return t(G,{children:t(Ae,{})});if(o||!r)return t(G,{childsCenter:!0,children:t(se,{})});const a=()=>()=>l(!0),c=()=>()=>l(!1);return i("section",{className:A.playlist,children:[i("div",{className:A.head,children:[t("h1",{className:A.title,children:`Playlist: ${r.length}`}),t(le,{onClick:a(),children:"Add new track"})]}),t(We,{data:r}),t(ot,{className:A.uploadModal,open:s,onClose:c(),children:t(mt,{onSubmit:c()})})]})},_t="_player_1glm3_1",pt="_musicImage_1glm3_57";var Y={player:_t,musicImage:pt};const ht="_wrapper_sfmsf_1",yt="_rewindControls_sfmsf_19",vt="_musicImage_sfmsf_29",gt="_button_sfmsf_37";var x={wrapper:ht,rewindControls:yt,musicImage:vt,button:gt};const bt="_box_dmcht_1";var xt={box:bt};const re=()=>t("div",{className:xt.box,children:t(P,{style:{fontSize:"1.7rem"},icon:pe,color:"black"})}),kt=({toggleAudio:e,nextTrack:o,prevTrack:n,playing:s})=>i("div",{className:x.wrapper,children:[t("div",{className:x.musicImage,children:t(re,{})}),t("button",{className:x.button,onClick:()=>e(),children:t(P,{size:"3x",icon:s?he:ye,color:"black"})}),i("div",{className:x.rewindControls,children:[t("button",{className:x.button,onClick:()=>n(),children:t(P,{size:"2x",icon:ve,color:"black"})}),t("button",{className:x.button,onClick:()=>o(),children:t(P,{size:"2x",icon:ge,color:"black"})})]})]}),Nt="_box_e863m_1",$t="_title_e863m_17";var Z={box:Nt,title:$t};const Tt=({volumeState:e,handleVolume:o})=>i("div",{className:Z.box,children:[i("p",{className:Z.title,children:["Volume: ",Math.round(e*100),"%"]}),t("input",{className:"clickable",type:"range",value:Math.round(e*100),onChange:n=>o(n)})]}),ee=e=>e<10?`0${e}`:`${e}`,te=e=>{const o=Math.floor(e/60),n=Math.floor(e%60);return`${ee(o)}:${ee(n)}`},wt="_infoInnerBox_1xn2v_1",Ct="_title_1xn2v_13",Bt="_progressBar_1xn2v_29",It="_info_1xn2v_1";var k={infoInnerBox:wt,title:Ct,progressBar:Bt,info:It};const St=({track:e,duration:o,currentTime:n,handleProgress:s,canChangeTime:l})=>i("div",{className:k.info,children:[i("div",{className:k.infoInnerBox,children:[t("h2",{className:k.title,children:e==null?void 0:e.title}),t("p",{children:te(o)})]}),i("div",{className:k.infoInnerBox,children:[t("h3",{className:k.title,children:e==null?void 0:e.author}),t("p",{children:te(n)})]}),t("input",{className:k.progressBar,type:"range",disabled:!l,onChange:s,value:o?Math.round(n*100/o):0})]});let m=new Audio,E=!0;const At=200,Mt=()=>{const e=N(Q),o=N(v),n=N(F),s=N(L),l=N(H),{data:r}=ne(U),a=r==null?void 0:r.getAllTracks,c=d=>{if(!!m.src)switch(d.code){case"Space":d.preventDefault(),_();break}};p.exports.useEffect(()=>(window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)),[]);const u=()=>{if(!a||!o)return;const d=a.indexOf(o);v(d===0?a[a.length-1]:a[d-1])},f=()=>{if(!a||!o)return;const d=a.indexOf(o);d===a.length-1?v(a[0]):v(a[d+1])},b=()=>f();p.exports.useEffect(()=>{o&&(m.src=o.src,m.ontimeupdate=()=>F(m.currentTime),m.onloadeddata=()=>{setTimeout(()=>{E=!0},At),Q(m.duration)},m.onended=()=>{E=!1,b()},_())},[o]);const _=async()=>{if(m.paused){L(!0);try{await m.play()}catch(d){console.log(d)}}else L(!1),m.pause()},y=d=>{const V=+d.target.value;if(E){const $=V*e/100;m.currentTime=$,F($)}},B=d=>{const $=+d.target.value/100;H($),m.volume=$};return o?i("div",{className:Y.player,children:[t(kt,{toggleAudio:_,nextTrack:f,prevTrack:u,playing:s}),t("div",{className:Y.musicImage,children:t(re,{})}),t(St,{track:o,duration:e,currentTime:n,handleProgress:y,canChangeTime:E}),t(Tt,{volumeState:l,handleVolume:B})]}):null},Et=()=>i("div",{className:"container",children:[t(Mt,{}),t(ft,{})]});be.render(t(xe.StrictMode,{children:t(ke,{client:Je,children:t(Et,{})})}),document.getElementById("root"));
