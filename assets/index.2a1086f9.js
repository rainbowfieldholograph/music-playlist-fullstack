var le=Object.defineProperty,ae=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var R=(n,t,o)=>t in n?le(n,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[t]=o,w=(n,t)=>{for(var o in t||(t={}))j.call(t,o)&&R(n,o,t[o]);if($)for(var o of $(t))z.call(t,o)&&R(n,o,t[o]);return n},E=(n,t)=>ae(n,re(t));var B=(n,t)=>{var o={};for(var s in n)j.call(n,s)&&t.indexOf(s)<0&&(o[s]=n[s]);if(n!=null&&$)for(var s of $(n))t.indexOf(s)<0&&z.call(n,s)&&(o[s]=n[s]);return o};import{j as U,c as b,g as ee,a as ce,I as ie,A as de,m as k,u as v,r as ue,b as f,d as me,e as te,F as A,f as pe,h as _e,i as he,k as fe,l as ge,R as ye,n as ve,o as xe}from"./vendor.07c8edb2.js";const be=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function o(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=o(l);fetch(l.href,a)}};be();const ke="_playlist_11scu_1",Ne="_title_11scu_23",Te="_head_11scu_33",$e="_uploadModal_11scu_45",we="_btn_11scu_57";var C={playlist:ke,title:Ne,head:Te,uploadModal:$e,btn:we};const Be="_title_xynlk_1";var Ce={title:Be};const e=U.exports.jsx,c=U.exports.jsxs,V=U.exports.Fragment,Ie=()=>e("div",{children:e("p",{className:Ce.title,children:"Connection Error"})}),Se="_block_11qbe_1";var Ae={block:Se};const O=s=>{var l=s,{children:n,className:t}=l,o=B(l,["children","className"]);return e("div",E(w({className:b(Ae.block,t)},o),{children:n}))},Me="_loadingWrapper_flrcn_1",Pe="_loading_flrcn_1",Ee="_load_flrcn_1";var K={loadingWrapper:Me,loading:Pe,load:Ee};const ne=()=>e("div",{className:K.loadingWrapper,children:e("div",{className:K.loading})}),q=ee`
  query GetAllTracks {
    getAllTracks {
      id
      title
      author
      src
    }
  }
`,Fe="_tracksBlock_diz2w_1";var Le={tracksBlock:Fe};const Ve="_track_dy45d_1",Ue="_info_dy45d_41",qe="_innerBox_dy45d_61",De="_text_dy45d_69",Re="_active_dy45d_89",je="_trackBox_dy45d_107";var m={track:Ve,info:Ue,innerBox:qe,text:De,active:Re,trackBox:je};const ze=({title:n,active:t,subtitle:o,onClick:s})=>c("button",{onClick:()=>s(),className:b(m.track,{[m.active]:t}),children:[e("div",{className:m.trackBox}),c("div",{className:m.info,children:[e("div",{className:m.innerBox,children:e("h2",{className:m.text,children:n})}),e("div",{className:m.innerBox,children:e("h3",{className:m.text,children:o})})]})]}),h=k(null),F=k(!1),W=k(1),L=k(0),G=k(0),Oe="https://eyes-closed-server.herokuapp.com/graphql",Ke=ce({uri:Oe}),We=new ie,Ge=new de({link:Ke,cache:We}),Qe=({data:n})=>{const t=v(h),o=s=>()=>h(s);return e("ul",{className:Le.tracksBlock,children:n.map(s=>e("li",{children:e(ze,{active:s.id===(t==null?void 0:t.id),onClick:o(s),title:s.title,subtitle:s.author})},s.id))})},He="_button_ptj0d_1";var Je={button:He};const oe=s=>{var l=s,{children:n,className:t}=l,o=B(l,["children","className"]);return e("button",E(w({className:b(Je.button,t)},o),{children:n}))},Xe="_modal_u0zos_1",Ye="_overlay_u0zos_31";var Q={modal:Xe,overlay:Ye};const H=document.getElementById("modal"),Ze=({className:n,children:t,open:o,onClose:s})=>!o||!H?e(V,{}):ue.exports.createPortal(c(V,{children:[e("div",{onClick:s,className:Q.overlay}),e("div",{className:b(Q.modal,n),children:t})]}),H),et="_form_1xdla_1",tt="_btn_1xdla_15",nt="_uploadTitle_1xdla_27",ot="_loadingTitle_1xdla_39";var I={form:et,btn:tt,uploadTitle:nt,loadingTitle:ot};const st=ee`
  mutation addTrack($title: String!, $author: String!, $file: Upload!) {
    addTrack(title: $title, author: $author, file: $file) {
      src
      author
      title
      id
    }
  }
`,lt="_input_uv6sf_1";var at={input:lt};const J=f.exports.memo(a=>{var r=a,{inputState:n,setInputState:t,labelText:o,className:s}=r,l=B(r,["inputState","setInputState","labelText","className"]);return c("label",{children:[e("h3",{children:o}),e("input",w({required:!0,className:b(at.input,s),value:n,onChange:u=>t(u.target.value),type:"text"},l))]})}),rt=({onSubmit:n})=>{const[t,o]=f.exports.useState(null),[s,l]=f.exports.useState(""),[a,r]=f.exports.useState(""),[u,{loading:M}]=me(st),N=p=>{var T;const _=(T=p.target.files)==null?void 0:T[0];_&&_.type.includes("audio/")?o(_):alert("Select audio/mpeg file")},P=async p=>{p.preventDefault();try{await u({variables:{title:s,author:a,file:t},refetchQueries:[{query:q}]}),n(),r(""),l("")}catch(_){alert("An error occurred while uploading the track to the server"),console.log("Upload failed: ",_)}};return M?c(V,{children:[e("p",{className:I.loadingTitle,children:"Uploading track. Please wait."}),e(ne,{})]}):c("form",{className:I.form,action:"",onSubmit:P,children:[e("h1",{children:"Upload Track"}),e(J,{inputState:a,setInputState:r,labelText:"Author"}),e(J,{inputState:s,setInputState:l,labelText:"Title"}),c("label",{children:[e("h1",{className:I.uploadTitle,children:"Upload audio File"}),e("input",{required:!0,type:"file",accept:"audio/*",onChange:N})]}),e(oe,{className:I.btn,type:"submit",children:"Upload Track"})]})},ct=()=>{const{data:n,loading:t,error:o}=te(q),[s,l]=f.exports.useState(!1),a=n==null?void 0:n.getAllTracks;if(o)return e(O,{children:e(Ie,{})});if(t||!a)return e(O,{children:e(ne,{})});const r=()=>()=>l(!0),u=()=>()=>l(!1);return c("section",{className:C.playlist,children:[c("div",{className:C.head,children:[e("h1",{className:C.title,children:`Playlist: ${a.length}`}),e(oe,{onClick:r(),children:"Add new track"})]}),e(Qe,{data:a}),e(Ze,{className:C.uploadModal,open:s,onClose:u(),children:e(rt,{onSubmit:u()})})]})},it="_player_1glm3_1",dt="_musicImage_1glm3_57";var X={player:it,musicImage:dt};const ut="_wrapper_sfmsf_1",mt="_rewindControls_sfmsf_19",pt="_musicImage_sfmsf_29",_t="_button_sfmsf_37";var g={wrapper:ut,rewindControls:mt,musicImage:pt,button:_t};const ht="_box_dmcht_1";var ft={box:ht};const se=()=>e("div",{className:ft.box,children:e(A,{style:{fontSize:"1.7rem"},icon:pe,color:"black"})}),gt=({toggleAudio:n,nextTrack:t,prevTrack:o,playing:s})=>c("div",{className:g.wrapper,children:[e("div",{className:g.musicImage,children:e(se,{})}),e("button",{className:g.button,onClick:()=>n(),children:e(A,{size:"3x",icon:s?_e:he,color:"black"})}),c("div",{className:g.rewindControls,children:[e("button",{className:g.button,onClick:()=>o(),children:e(A,{size:"2x",icon:fe,color:"black"})}),e("button",{className:g.button,onClick:()=>t(),children:e(A,{size:"2x",icon:ge,color:"black"})})]})]}),yt="_box_e863m_1",vt="_title_e863m_17";var Y={box:yt,title:vt};const xt=({volumeState:n,handleVolume:t})=>c("div",{className:Y.box,children:[c("p",{className:Y.title,children:["Volume: ",Math.round(n*100),"%"]}),e("input",{className:"clickable",type:"range",value:Math.round(n*100),onChange:o=>t(o)})]}),Z=n=>{const t=Math.floor(n/60),o=Math.floor(n%60),s=t<10?`0${t}`:`${t}`,l=o<10?`0${o}`:`${o}`;return`${s}:${l}`},bt="_infoInnerBox_1xn2v_1",kt="_title_1xn2v_13",Nt="_progressBar_1xn2v_29",Tt="_info_1xn2v_1";var y={infoInnerBox:bt,title:kt,progressBar:Nt,info:Tt};const $t=({track:n,duration:t,currentTime:o,handleProgress:s,canChangeTime:l})=>c("div",{className:y.info,children:[c("div",{className:y.infoInnerBox,children:[e("h2",{className:y.title,children:n==null?void 0:n.title}),e("p",{children:Z(t)})]}),c("div",{className:y.infoInnerBox,children:[e("h3",{className:y.title,children:n==null?void 0:n.author}),e("p",{children:Z(o)})]}),e("input",{className:y.progressBar,type:"range",disabled:!l,onChange:s,value:t?Math.round(o*100/t):0})]});let d=new Audio,S=!0;const wt=200,Bt=()=>{const n=v(G),t=v(h),o=v(L),s=v(F),l=v(W),{data:a}=te(q),r=a==null?void 0:a.getAllTracks,u=i=>{if(!!d.src)switch(i.code){case"Space":i.preventDefault(),p();break}};f.exports.useEffect(()=>(window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)),[]);const M=()=>{if(!r||!t)return;const i=r.indexOf(t);h(i===0?r[r.length-1]:r[i-1])},N=()=>{if(!r||!t)return;const i=r.indexOf(t);i===r.length-1?h(r[0]):h(r[i+1])},P=()=>N();f.exports.useEffect(()=>{t&&(d.src=t.src,d.ontimeupdate=()=>L(d.currentTime),d.onloadeddata=()=>{setTimeout(()=>{S=!0},wt),G(d.duration)},d.onended=()=>{S=!1,P()},p())},[t]);const p=async()=>{if(d.paused){F(!0);try{await d.play()}catch(i){console.log(i)}}else F(!1),d.pause()},_=i=>{const D=+i.target.value;if(S){const x=D*n/100;d.currentTime=x,L(x)}},T=i=>{const x=+i.target.value/100;W(x),d.volume=x};return t?c("div",{className:X.player,children:[e(gt,{toggleAudio:p,nextTrack:N,prevTrack:M,playing:s}),e("div",{className:X.musicImage,children:e(se,{})}),e($t,{track:t,duration:n,currentTime:o,handleProgress:_,canChangeTime:S}),e(xt,{volumeState:l,handleVolume:T})]}):null},Ct=()=>c("div",{className:"container",children:[e(Bt,{}),e(ct,{})]});ye.render(e(ve.StrictMode,{children:e(xe,{client:Ge,children:e(Ct,{})})}),document.getElementById("root"));
